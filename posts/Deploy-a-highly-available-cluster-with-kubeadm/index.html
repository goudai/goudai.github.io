<!doctype html>
<html lang="zh-CN">
<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <meta name="referrer" content="no-referrer-when-downgrade">
    

    <title>在阿里云的VPC部署高可用kubernetes | 青木的博客</title>
    <meta property="og:title" content="在阿里云的VPC部署高可用kubernetes - 青木的博客">
    <meta property="og:type" content="article">
        
    <meta property="article:published_time" content='2019-05-17T20:47:35&#43;08:00'>
        
        
    <meta property="article:modified_time" content='2019-05-17T20:47:35&#43;08:00'>
        
    <meta name="Keywords" content="golang,go语言,go语言笔记,青木,java,博客,项目管理,软件架构">
    <meta name="description" content="在阿里云的VPC部署高可用kubernetes">
        
    <meta name="author" content="青木">
    <meta property="og:url" content="https://www.flysnow.org/posts/Deploy-a-highly-available-cluster-with-kubeadm/">
    <link rel="shortcut icon" href='/favicon.ico'  type="image/x-icon">

    <link rel="stylesheet" href='/css/normalize.css'>
    <link rel="stylesheet" href='/css/style.css'>
    <script type="text/javascript" src="//cdn.bootcdn.net/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

    
    
    
    
    
    
        <link rel="stylesheet" href='/css/douban.css'>
    
        <link rel="stylesheet" href='/css/other.css'>
    
</head>

<body>
    <header id="header" class="clearfix">
    <div class="container">
        <div class="col-group">
            <div class="site-name ">
                
                    <a id="logo" href="https://www.flysnow.org">
                        青木的博客
                    </a>
                
                <p class="description">道可道，非常道；名可名，非常名。</p>
            </div>
            <div>
                <nav id="nav-menu" class="clearfix">
                    <a class="current" href="https://www.flysnow.org">首页</a>
                    
                    <a  href="https://goudai.github.io/categories/" title="归档">归档</a>
                    
                </nav>
            </div>
        </div>
    </div>
</header>

    <div id="body">
        <div class="container">
            <div class="col-group">

                <div class="col-8" id="main">
                    
<div class="res-cons">
    <style type="text/css">
    .post-toc {
        position: fixed;
        width: 200px;
        margin-left: -210px;
        padding: 5px 10px;
        font-family: Athelas, STHeiti, Microsoft Yahei, serif;
        font-size: 12px;
        border: 1px solid rgba(0, 0, 0, .07);
        border-radius: 5px;
        background-color: rgba(255, 255, 255, 0.98);
        background-clip: padding-box;
        -webkit-box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        box-shadow: 1px 1px 2px rgba(0, 0, 0, .125);
        word-wrap: break-word;
        white-space: nowrap;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        z-index: 999;
        cursor: pointer;
        max-height: 70%;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .post-toc .post-toc-title {
        width: 100%;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 400;
        text-transform: uppercase;
        text-align: center;
    }

    .post-toc .post-toc-content {
        font-size: 15px;
    }

    .post-toc .post-toc-content>nav>ul {
        margin: 10px 0;
    }

    .post-toc .post-toc-content ul {
        padding-left: 20px;
        list-style: square;
        margin: 0.5em;
        line-height: 1.8em;
    }

    .post-toc .post-toc-content ul ul {
        padding-left: 15px;
        display: none;
    }

    @media print,
    screen and (max-width:1057px) {
        .post-toc {
            display: none;
        }
    }
</style>
<div class="post-toc" style="position: absolute; top: 188px;">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#我应该如何选择master节点的配置">我应该如何选择master节点的配置</a></li>
  </ul>

  <ul>
    <li><a href="#升级内核">升级内核</a></li>
    <li><a href="#启用ipvs相关内核module">启用IPVS相关内核module</a></li>
    <li><a href="#内核参数调整">内核参数调整</a></li>
    <li><a href="#禁用swap并关闭防火墙">禁用swap并关闭防火墙</a></li>
    <li><a href="#安装必须软件">安装必须软件</a></li>
    <li><a href="#配置镜像">配置镜像</a></li>
    <li><a href="#更新apt镜像源并升级相关软件">更新apt镜像源并升级相关软件</a></li>
    <li><a href="#安装docker-ce">安装Docker-ce</a></li>
    <li><a href="#配置docker">配置Docker</a></li>
  </ul>

  <ul>
    <li><a href="#nginxconf">Nginx.conf</a></li>
    <li><a href="#启动nginx">启动Nginx</a></li>
  </ul>

  <ul>
    <li><a href="#font-colorred注意事项font"><!-- raw HTML omitted -->注意事项<!-- raw HTML omitted --></a></li>
    <li><a href="#docker安装etcd">docker安装ETCD</a></li>
  </ul>

  <ul>
    <li><a href="#安装kubernetes基础组件">安装kubernetes基础组件</a>
      <ul>
        <li><a href="#关于kubeadm自动签发的证书一年过期的问题">关于kubeadm自动签发的证书一年过期的问题</a></li>
        <li><a href="#设置镜像源">设置镜像源</a></li>
        <li><a href="#安装kubeadm-kubelet-kubectl">安装<code>kubeadm kubelet kubectl</code></a></li>
        <li><a href="#设置kubelet的pause镜像">设置kubelet的pause镜像</a></li>
      </ul>
    </li>
    <li><a href="#kubeadm-configyaml">Kubeadm-config.yaml</a></li>
    <li><a href="#预拉取镜像">预拉取镜像</a></li>
    <li><a href="#初始化master">初始化Master</a></li>
  </ul>

  <ul>
    <li><a href="#查看集群状态">查看集群状态</a></li>
  </ul>
</nav>
    </div>
</div>
<script type="text/javascript">
    $(document).ready(function () {
        var postToc = $(".post-toc");
        if (postToc.length) {
            var leftPos = $("#main").offset().left;
            if (leftPos < 220) {
                postToc.css({ "width": leftPos - 10, "margin-left": (0 - leftPos) })
            }

            var t = postToc.offset().top - 20,
                a = {
                    start: {
                        position: "absolute",
                        top: t
                    },
                    process: {
                        position: "fixed",
                        top: 20
                    },
                };
            $(window).scroll(function () {
                var e = $(window).scrollTop();
                e < t ? postToc.css(a.start) : postToc.css(a.process)
            })
        }

        if ($("#TableOfContents").children().length < 1) {
            $(".post-toc").remove();
        }
    })
</script>
    <article class="post">
        <header>
            <h1 class="post-title">在阿里云的VPC部署高可用kubernetes</h1>
        </header>
        <date class="post-meta meta-date">
            2019年5月17日
        </date>
        
        
        <div class="post-meta">
            <span id="busuanzi_container_page_pv">|<span id="busuanzi_value_page_pv"></span><span>
                    阅读</span></span>
        </div>
        
        
        <div class="post-content">
            <h1 id="kubernetes的基本概念">kubernetes的基本概念</h1>
<h1 id="font-colorred写在前面的话font"><!-- raw HTML omitted -->写在前面的话<!-- raw HTML omitted --></h1>
<p>整个安装过程中尽量不要出现写死的IP的情况出现，尽量全部使用域名代替IP。
网上大量的人使用KeepAlive+VIP的形式完成高可用，这个方式有两个不好的地方：
其一，受限于使用者的网络，无法适用于SDN网络，比如Aliyun的VPC。
其二，虽然是高可用的，但是流量还是单点的，所有node的的网络I/O都会高度集中于一台机器上（VIP)。
本文的高可用可通用于任何云上的SDN环境和自建机房环境，如阿里云的VPC环境中。</p>
<h1 id="kubernetes-高可用架构图">kubernetes 高可用架构图</h1>
<p>ETCD 高可用

        <img class="mx-auto" alt="" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIzNjciIGhlaWdodD0iMjE3IiB2aWV3Qm94PSItMC41IC0wLjUgMzY3IDIxNyIgY29udGVudD0iJmx0O214ZmlsZSBtb2RpZmllZD0mcXVvdDsyMDE5LTA3LTE3VDEwOjQ1OjI0LjMwM1omcXVvdDsgaG9zdD0mcXVvdDsmcXVvdDsgYWdlbnQ9JnF1b3Q7TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTRfNCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgZHJhdy5pby8xMC45LjUgQ2hyb21lLzczLjAuMzY4My4xMjEgRWxlY3Ryb24vNS4wLjYgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O2FrTWc0dlYyU2JQOVhxY2ZHVktHJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTAuOS41JnF1b3Q7IHR5cGU9JnF1b3Q7ZGV2aWNlJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90O25EaFNSZXgtQ1BQSjItTUdLUDU5JnF1b3Q7IG5hbWU9JnF1b3Q756ysIDEg6aG1JnF1b3Q7Jmd0OzdaakxjdG93RklhZmhtVTYyTElOTExrMm0wNHZaS1pOTngzVkZsaURzRHl5QUx0UFh5bVdiR1E1Z1E0UXMrZ21JLzI2bnUvOGxoUjZZTHJOUHpLWXhwOW9oRWpQN1VkNUQ4eDZyanZ5QXZGWENrVXBCRUFKYTRhalVuSnFZWW4vSUNYMmxickRFY3FNanB4U3duRnFpaUZORWhSeVE0T00wWVBaYlVXSnVXb0sxOGdTbGlFa3R2b2RSend1MWFFN3FQVkhoTmV4WHRrSlJtWExGdXJPS3BJc2hoRTlIRWxnM2dOVFJpa3ZTOXQ4aW9oa3A3bVU0eGF2dEZZYll5amg1d3o0K1RYeEZ1ajNKUHVWckI3ajhUQ0pQNDhmMUN4N1NIWXFZTFZaWG1nQ2pPNlNDTWxKbkI2WUhHTE0wVEtGb1d3OWlKUUxMZVpib3ByVmRJaHhsTCs2VDZlS1hyZ0cwUzNpckJCZDlJQ0JBcVljNHc1Vi9WRHpCNEhTNGlQMmxXZWd5dm02bXJ2R0lncUt6RDlRQWhhbCtkTjA1blNQYW1TaUFpTWJsZE52UWVYZGlwVFhTcXA3VTRIK3ZaSHlXMG1CemtsNURyZ3pVc0hwTTBxY3Jha3NoanRHaWdtRDRRYngwN1JNdEJGbTRnTEJOQkgxaERJWjZ6VjRWbHdVVDgremVWWjlqT1BzVmp4SEZzOXY0OFdUeFZTRXpFMWVHV2QwZzZhVVVQYkNLQkU5Snl0TVNFT0NCSzhseFZBZ1FrS2ZTSUJZM0tsajFiREZVU1NYYVUxUW5aWCtsYjU5cDVHQndNN0F1eWJBc1cvZHpUQ1RLNlg0SVVOTVJOdjVNVkRkdXZvV2Jqc0czQlpxd2Myb3VhZlBBZkg5N3l0SUtJbkc4Z1VvblVoZ2x1SFFwQ1JJc09LSDlOa0hYMWVmbGUxZUtyUGNxQlc2bG1OK05FelVudldNb2x3UGtoVTlwdHdwaXF6SFppTWZJaHE2WXlFNnd6MGNzalhpcDE0dGRvS1BFdWkzNUU5ckRCSEk4ZDdjYjF0UzFRcGZLQmFSMUUrVHdQU1AzL1JGR2FjYWRmeHNiVXprTnI1ZXYvbktLemxZRTRuVXcrS29XeW83Wks5djJHMXNHUGpHYzFvVXlobHJBMWRNTC9DMC9iTDg3K20zUE8zZms2Y0RjQzFQRDIvamFRODBQQjI4aDZmdC93RzY4ZlQ1L2p4cE82OUwyK21UcUhreVhXeTdvRG5SbFd3SEJtOGVwYWNESEZ4a1UxR3RmMVVwdTljL1RZSDVYdz09Jmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI&#43;PGRlZnM&#43;PGZpbHRlciBpZD0iZHJvcFNoYWRvdyI&#43;PGZlR2F1c3NpYW5CbHVyIGluPSJTb3VyY2VBbHBoYSIgc3RkRGV2aWF0aW9uPSIxLjciIHJlc3VsdD0iYmx1ciIvPjxmZU9mZnNldCBpbj0iYmx1ciIgZHg9IjMiIGR5PSIzIiByZXN1bHQ9Im9mZnNldEJsdXIiLz48ZmVGbG9vZCBmbG9vZC1jb2xvcj0iIzNENDU3NCIgZmxvb2Qtb3BhY2l0eT0iMC40IiByZXN1bHQ9Im9mZnNldENvbG9yIi8&#43;PGZlQ29tcG9zaXRlIGluPSJvZmZzZXRDb2xvciIgaW4yPSJvZmZzZXRCbHVyIiBvcGVyYXRvcj0iaW4iIHJlc3VsdD0ib2Zmc2V0Qmx1ciIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9Im9mZnNldEJsdXIiLz48L2ZpbHRlcj48L2RlZnM&#43;PGcgZmlsdGVyPSJ1cmwoI2Ryb3BTaGFkb3cpIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMzYwIiBoZWlnaHQ9IjIxMCIgcng9IjMxLjUiIHJ5PSIzMS41IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHJlY3QgeD0iMjAiIHk9IjExMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI0MCIgcng9IjYiIHJ5PSI2IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDkuNSwxMjMuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNDAiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNDBweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPkVUQ0QxPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjIwIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5FVENEMTwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iMTMwIiB5PSIxMTAiIHdpZHRoPSIxMDAiIGhlaWdodD0iNDAiIHJ4PSI2IiByeT0iNiIgZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE1OS41LDEyMy41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI0MCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA0MHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;RVRDRDI8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMjAiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPkVUQ0QyPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIyNDMiIHk9IjExMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSI0MCIgcng9IjYiIHJ5PSI2IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjcyLjUsMTIzLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjQwIiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDQwcHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5FVENEMzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyMCIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;RVRDRDM8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxwYXRoIGQ9Ik0gMjAwIDUwIEwgMTk1IDUwIFEgMTkwIDUwIDE5MCA2MCBMIDE5MCAxNjAgUSAxOTAgMTcwIDE4NSAxNzAgTCAxODIuNSAxNzAgUSAxODAgMTcwIDE4NSAxNzAgTCAxODcuNSAxNzAgUSAxOTAgMTcwIDE5MCAxODAgTCAxOTAgMjgwIFEgMTkwIDI5MCAxOTUgMjkwIEwgMjAwIDI5MCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHRyYW5zZm9ybT0icm90YXRlKDI3MCwxOTAsMTcwKSIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNDMuNSwxODMuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMzIiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogMzJweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPlJBRlQ8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMTYiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPlJBRlQ8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjExMCIgeT0iMTAiIHdpZHRoPSIxMjAiIGhlaWdodD0iNjAiIHJ4PSI5IiByeT0iOSIgZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEzMS41LDMzLjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9Ijc2IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDc2cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5rOHMgYXBpLXNlcnZlcjwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzOCIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;azhzIGFwaS1zZXJ2ZXI8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxwYXRoIGQ9Ik0gMTcwIDcwIFEgOTAgNzAgNzIuODUgMTA0LjMiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gNzAuNSAxMDkgTCA3MC41IDEwMS4xNyBMIDcyLjg1IDEwNC4zIEwgNzYuNzYgMTA0LjMgWiIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAxNzAgNzAgUSAyNjAgODAgMjg4LjI5IDEwNS43MiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAyOTIuMTcgMTA5LjI1IEwgMjg0LjY0IDEwNy4xMyBMIDI4OC4yOSAxMDUuNzIgTCAyODkuMzUgMTAxLjk1IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMTgwIDcwIFEgMjAwIDcwIDE5MCA4MCBRIDE4MCA5MCAxODAgMTAzLjYzIiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDE4MCAxMDguODggTCAxNzYuNSAxMDEuODggTCAxODAgMTAzLjYzIEwgMTgzLjUgMTAxLjg4IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjwvZz48L3N2Zz4=" />   
    </p>
<p>API-Server 高可用

        <img class="mx-auto" alt="api HA" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2NDgiIGhlaWdodD0iMzE4IiB2aWV3Qm94PSItMC41IC0wLjUgNjQ4IDMxOCIgY29udGVudD0iJmx0O214ZmlsZSBtb2RpZmllZD0mcXVvdDsyMDE5LTA3LTE3VDA5OjM3OjA5LjAzMVomcXVvdDsgaG9zdD0mcXVvdDsmcXVvdDsgYWdlbnQ9JnF1b3Q7TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTRfNCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgZHJhdy5pby8xMC45LjUgQ2hyb21lLzczLjAuMzY4My4xMjEgRWxlY3Ryb24vNS4wLjYgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O1VmbDA5SXZ0a1RNVEtpclBnbHpBJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTAuOS41JnF1b3Q7IHR5cGU9JnF1b3Q7ZGV2aWNlJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90O2FVMDJkMjJqb280Q0FrTW1BMXpaJnF1b3Q7IG5hbWU9JnF1b3Q756ysIDEg6aG1JnF1b3Q7Jmd0OzdWcGJqNXM0RlA0MWVXeUVNZGZISnAxMnBWNmxXZTIyanc0NFlBM0JDSnlHOU5ldkhXd3VOdEdrazRHMG5YMko3QU8yajcvdlhIeE1GbkM5cTkrVnFFZy8waGhuQzl1SzZ3VjhzN0R0MFBINHJ4QWNHNEVIcFNBcFNkeUlRQ2U0Snord0ZGcFN1aWN4cmdZdk1rb3pSb3FoTUtKNWppTTJrS0d5cElmaGExdWFEVmN0VUlJTndYMkVNbFA2TDRsWjJrZ0QyKy9rZjJHU3BHcGw0SVhOa3gxU0w4dWRWQ21LNmFFbmduY0x1QzRwWlUxclY2OXhKckJUdURUajNwNTUyaXBXNHB4ZE1xQytJKysyUHhMd1B2NzRlWk4rOE5IZm1MMnlnMmFhN3lqYnl4MUxiZGxSUVZEU2ZSNWpNUXRZd05VaEpRemZGeWdTVHcrY2N5NUwyUzZUajVNTVZRSnlpN2NqdWlPUmJGZXNwQTh0aEh6eksxUkdrbTd4ZkV1eWJFMHpXcDdXaE50dEZJVmhPNjczQkhvd2hGeVpsVlFjbHd6WFp5RUJMZERjUURIZFlWWWUrU3RxZ0NXNWtjWVp5dTZoWTlwenBDenRzUXlWZFNKcFhVazdkVWNBYjBnT2ZvSVB4NkFERmVSVmhVdSt6NFh0WlZ5QjFVYTBFdEVDb2IwRVhyQzBsdUE2MWt4MmREN0NyUzhtbTVnUE1PUUR1Q1loSUJnaHhKdUtELzlKZklBL2xJODJsdDJNRHpOY1hjS0gvYWZ5TVJLdzV1VkRLZlJzK2VNWFFkb0p0RWprbVVqYjdnalNZRHFvZ1FIMXczNkRNOHl1UTd5ZnBmdlorMUVtb2dpNzIrM1VUSGk2elkva2hIQ0VDR2N5SG15RGh6d2hlYzFGR2VVSFJ4NTgwRTVnbkcrcTRvU0JIcGFLa3RaSFU5eEVzZVZEVUMzbFJOZlFlaE95RExjSkxpUExuWXlzQzg2MzBaN2pybERGZWZ4YWxBMjhHd2xuRUs1eFBqN0Iwd2l1Nk5kMk9POThFeDYwZEZYM1RTMDlxdWtkVmE4bTdHdXYzUnZGZTkwZzBWRmpHdDF4Yk5Rc0drRjhmM1JmUnZnQ00yYW9UREI3TE9XYWpQY1lIWXVEU2xiaURESHlmYWp2R00xeWhTK1U4SjIwQmdYZG9VRkIzYTJiZmNwUi9lcEhtOGl4enFST05WR0RnekVSTndaMDdMMVdpQmVxOHdycjZ5aUZ6K21sYjFEcDFSbDlvMEhuQWkwSFYzaEYrTDlYWE9rVi9rMjl3am1URTMvV0syQ29UV1JONHhYR091NGpYcUZ2MEpyQksxUng4OXQ0aFQyZlcxZ1h1b1Z6UzdjQWNHZzF6bE9UQmRDT01YQ3FaS0dadVNvZUxrMFd3Sm5ETGN5NnczTWNhTGdHbjRvVUZSWjJuNklDbjV5Qzd1UExyd3o3eGNqSUNYYWV3cy9XSVI0cC9QdzV5dzBWaEY0bS9GeHdZL2poeTRMZkhRWSs2OWJXYjE3QVhwZVQ1enlYbXZuL09WT3kraHIyV0VwdWpyUzN5c25HOVkzdlBpMG51M3Brc0xTSm5pa25HK3RJaGMvcFpXeHdscU9xK1owb3VFVlVtdWRXeWZXSFVRbU1YSHZQRzVYTSt2bWZMMnNEZmI1ak5sWVJLSmh5bW1NTlV5bENHVWx5d1JaSENIUDVTdUJISXBTOWxnOTJKSTdGTXFNOGR2ZUUrcDF1LzY3M0dZZ0J0blpZR2trWFk5OVA3YW1JVVFYQUlGMjh4U3ppdnltdGhOOGIzNGhzZnlrK0Qxa1ZYcDV1WGcwYXI3cDJqZkVtMkV4KzdhcVgxNTU1YXByMTJoV2FOY01uR3VPWDV5R2VyM21JUDVtSDhHNzNaNUltMFhUL3lJRjMvd0U9Jmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI&#43;PGRlZnM&#43;PGZpbHRlciBpZD0iZHJvcFNoYWRvdyI&#43;PGZlR2F1c3NpYW5CbHVyIGluPSJTb3VyY2VBbHBoYSIgc3RkRGV2aWF0aW9uPSIxLjciIHJlc3VsdD0iYmx1ciIvPjxmZU9mZnNldCBpbj0iYmx1ciIgZHg9IjMiIGR5PSIzIiByZXN1bHQ9Im9mZnNldEJsdXIiLz48ZmVGbG9vZCBmbG9vZC1jb2xvcj0iIzNENDU3NCIgZmxvb2Qtb3BhY2l0eT0iMC40IiByZXN1bHQ9Im9mZnNldENvbG9yIi8&#43;PGZlQ29tcG9zaXRlIGluPSJvZmZzZXRDb2xvciIgaW4yPSJvZmZzZXRCbHVyIiBvcGVyYXRvcj0iaW4iIHJlc3VsdD0ib2Zmc2V0Qmx1ciIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9Im9mZnNldEJsdXIiLz48L2ZpbHRlcj48L2RlZnM&#43;PGcgZmlsdGVyPSJ1cmwoI2Ryb3BTaGFkb3cpIj48cmVjdCB4PSIxIiB5PSIxIiB3aWR0aD0iNjQwIiBoZWlnaHQ9IjMxMCIgZmlsbD0iI2ZmY2M5OSIgc3Ryb2tlPSIjMzYzOTNkIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHJlY3QgeD0iMTEiIHk9IjYxIiB3aWR0aD0iMTgwIiBoZWlnaHQ9IjYwIiByeD0iOSIgcnk9IjkiIGZpbGw9IiNmOWY3ZWQiIHN0cm9rZT0iIzM2MzkzZCIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY4LjUsNzcuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNjMiIGhlaWdodD0iMjYiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNjVweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPmFwaS1zZXJ2ZXI8YnIgLz4xOTIuMTY4LjAuMTwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzMiIgeT0iMTkiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;YXBpLXNlcnZlciZsdDticiZndDsxOTIuMTY4LjAuMTwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iMTEiIHk9IjEzMSIgd2lkdGg9IjE4MCIgaGVpZ2h0PSI2MCIgcng9IjkiIHJ5PSI5IiBmaWxsPSIjZjlmN2VkIiBzdHJva2U9IiMzNjM5M2QiIHN0cm9rZS13aWR0aD0iMiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg2OC41LDE0Ny41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI2MyIgaGVpZ2h0PSIyNiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA2NXB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;YXBpLXNlcnZlcjxiciAvPjE5Mi4xNjguMS4xPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjMyIiB5PSIxOSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5hcGktc2VydmVyJmx0O2JyJmd0OzE5Mi4xNjguMS4xPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxMSIgeT0iMjAxIiB3aWR0aD0iMTgwIiBoZWlnaHQ9IjYwIiByeD0iOSIgcnk9IjkiIGZpbGw9IiNmOWY3ZWQiIHN0cm9rZT0iIzM2MzkzZCIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDY4LjUsMjE3LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjYzIiBoZWlnaHQ9IjI2IiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDY1cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5hcGktc2VydmVyPGJyIC8&#43;MTkyLjE2OC4yLjE8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMzIiIHk9IjE5IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPmFwaS1zZXJ2ZXImbHQ7YnImZ3Q7MTkyLjE2OC4yLjE8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjM4MSIgeT0iNzEiIHdpZHRoPSIyNTAiIGhlaWdodD0iMTYwIiByeD0iMjQiIHJ5PSIyNCIgZmlsbD0iI2Y5ZjdlZCIgc3Ryb2tlPSIjMzYzOTNkIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHJlY3QgeD0iNTExIiB5PSIxNjEiIHdpZHRoPSI5MCIgaGVpZ2h0PSI0MCIgcng9IjYiIHJ5PSI2IiBmaWxsPSIjY2NlNWZmIiBzdHJva2U9IiMzNjM5M2QiIHN0cm9rZS13aWR0aD0iMiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MzUuNSwxNzQuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMzkiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogMzlweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPmt1YmVsZXQ8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMjAiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPmt1YmVsZXQ8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjM4MSIgeT0iOTEiIHdpZHRoPSI5MCIgaGVpZ2h0PSI1MCIgcng9IjcuNSIgcnk9IjcuNSIgZmlsbD0iI2NjZTVmZiIgc3Ryb2tlPSIjMzYzOTNkIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM4NC41LDk1LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjgyIiBoZWlnaHQ9IjQwIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDg0cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5uZ2lueCBsb2NhbMKgPGJyIC8&#43;cHJveHk8YnIgLz5zZXJ2ZXIuazhzLmxvY2FsPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjQxIiB5PSIyNiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iJ0hlbHZldGljYSciPltOb3Qgc3VwcG9ydGVkIGJ5IHZpZXdlcl08L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxwYXRoIGQ9Ik0gMzgxIDExNiBRIDMwMSAyNTEgMjc2IDIyNiBRIDI1MSAyMDEgMjAwLjA0IDIyNi40OCIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDE5NCAyMjkuNSBMIDIwMC4wNCAyMjEuNDUgTCAyMDAuMDQgMjI2LjQ4IEwgMjA0LjA2IDIyOS41IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAzODEgMTE2IFEgMjkxIDE2MSAyNjYgMTM2IFEgMjQxIDExMSAxOTguMTQgMTUzLjg2IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMTkzLjM3IDE1OC42MyBMIDE5Ni41NSAxNDkuMDggTCAxOTguMTQgMTUzLjg2IEwgMjAyLjkyIDE1NS40NSBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS13aWR0aD0iMyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMzgxIDExMSBRIDM0MSA3MSAyOTYgNjEgUSAyNTEgNTEgMTk5LjQxIDg1LjQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAxOTMuNzkgODkuMTQgTCAxOTguNzggODAuNCBMIDE5OS40MSA4NS40IEwgMjAzLjc4IDg3Ljg5IFoiIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAxNjguNSA4MSBDIDE1NC41IDgxIDE1MSA5MSAxNjIuMiA5MyBDIDE1MSA5Ny40IDE2My42IDEwNyAxNzIuNyAxMDMgQyAxNzkgMTExIDIwMCAxMTEgMjA3IDEwMyBDIDIyMSAxMDMgMjIxIDk1IDIxMi4yNSA5MSBDIDIyMSA4MyAyMDcgNzUgMTk0Ljc1IDc5IEMgMTg2IDczIDE3MiA3MyAxNjguNSA4MSBMIDE2OC41IDgxIFogWiIgZmlsbD0iI2Y5ZjdlZCIgc3Ryb2tlPSIjMzYzOTNkIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNzIuNSw4NC41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNiIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyOHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;NjQ0MzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMyIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;NjQ0MzwvdGV4dD48L3N3aXRjaD48L2c&#43;PHBhdGggZD0iTSAxNjguNSAxNDYgQyAxNTQuNSAxNDYgMTUxIDE1NiAxNjIuMiAxNTggQyAxNTEgMTYyLjQgMTYzLjYgMTcyIDE3Mi43IDE2OCBDIDE3OSAxNzYgMjAwIDE3NiAyMDcgMTY4IEMgMjIxIDE2OCAyMjEgMTYwIDIxMi4yNSAxNTYgQyAyMjEgMTQ4IDIwNyAxNDAgMTk0Ljc1IDE0NCBDIDE4NiAxMzggMTcyIDEzOCAxNjguNSAxNDYgTCAxNjguNSAxNDYgWiBaIiBmaWxsPSIjZjlmN2VkIiBzdHJva2U9IiMzNjM5M2QiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3Mi41LDE0OS41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNiIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyOHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;NjQ0MzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMyIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;NjQ0MzwvdGV4dD48L3N3aXRjaD48L2c&#43;PHBhdGggZD0iTSAxNzMuNSAyMjEgQyAxNTkuNSAyMjEgMTU2IDIzMSAxNjcuMiAyMzMgQyAxNTYgMjM3LjQgMTY4LjYgMjQ3IDE3Ny43IDI0MyBDIDE4NCAyNTEgMjA1IDI1MSAyMTIgMjQzIEMgMjI2IDI0MyAyMjYgMjM1IDIxNy4yNSAyMzEgQyAyMjYgMjIzIDIxMiAyMTUgMTk5Ljc1IDIxOSBDIDE5MSAyMTMgMTc3IDIxMyAxNzMuNSAyMjEgTCAxNzMuNSAyMjEgWiBaIiBmaWxsPSIjZjlmN2VkIiBzdHJva2U9IiMzNjM5M2QiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE3Ny41LDIyNC41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNiIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyOHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;NjQ0MzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMyIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;NjQ0MzwvdGV4dD48L3N3aXRjaD48L2c&#43;PHBhdGggZD0iTSA1MTEgMTgxIFEgNDUxIDE4NiA0ODEgMTQ4LjUgUSA1MTEgMTExIDQ4MS4wMyAxMTQuNzUiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLXdpZHRoPSIzIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSA0NzQuMzMgMTE1LjU4IEwgNDgyLjcgMTEwIEwgNDgxLjAzIDExNC43NSBMIDQ4My44MiAxMTguOTMgWiIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2Utd2lkdGg9IjMiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDQ5My41IDExMSBDIDQ3OS41IDExMSA0NzYgMTIxIDQ4Ny4yIDEyMyBDIDQ3NiAxMjcuNCA0ODguNiAxMzcgNDk3LjcgMTMzIEMgNTA0IDE0MSA1MjUgMTQxIDUzMiAxMzMgQyA1NDYgMTMzIDU0NiAxMjUgNTM3LjI1IDEyMSBDIDU0NiAxMTMgNTMyIDEwNSA1MTkuNzUgMTA5IEMgNTExIDEwMyA0OTcgMTAzIDQ5My41IDExMSBMIDQ5My41IDExMSBaIFoiIGZpbGw9IiNjY2U1ZmYiIHN0cm9rZT0iIzM2MzkzZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDk3LjUsMTE0LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjI2IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDI4cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij44NDQzPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjEzIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj44NDQzPC90ZXh0Pjwvc3dpdGNoPjwvZz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyOC41LDE0LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDI2cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5WUEM8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMTIiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPlZQQzwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iMzkxIiB5PSIxNzYiIHdpZHRoPSI5MCIgaGVpZ2h0PSI1MCIgcng9IjcuNSIgcnk9IjcuNSIgZmlsbD0iI2NkZWI4YiIgc3Ryb2tlPSIjMzYzOTNkIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDM5Ni41LDE4Ny41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI3OCIgaGVpZ2h0PSIyNiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA4MHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;L2V0Yy9ob3N0czxiciAvPjEyNy4uMSBzZS44cy5sbzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzOSIgeT0iMTkiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;L2V0Yy9ob3N0cyZsdDticiZndDsxMjcuLjEgc2UuOHMubG88L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDU3Ni41LDg0LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjI4IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDMwcHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5Ob2RlPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjE0IiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5Ob2RlPC90ZXh0Pjwvc3dpdGNoPjwvZz48L2c&#43;PC9zdmc&#43;" />   
    
云上部署到多可用区

        <img class="mx-auto" alt="多可用区" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSI2MjgiIGhlaWdodD0iMzg4IiB2aWV3Qm94PSItMC41IC0wLjUgNjI4IDM4OCIgY29udGVudD0iJmx0O214ZmlsZSBtb2RpZmllZD0mcXVvdDsyMDE5LTA3LTE3VDEwOjEzOjU3Ljc4N1omcXVvdDsgaG9zdD0mcXVvdDsmcXVvdDsgYWdlbnQ9JnF1b3Q7TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTRfNCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgZHJhdy5pby8xMC45LjUgQ2hyb21lLzczLjAuMzY4My4xMjEgRWxlY3Ryb24vNS4wLjYgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O1JSUmx2OEZVVUJHZnVBVkk4QnREJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTAuOS41JnF1b3Q7IHR5cGU9JnF1b3Q7ZGV2aWNlJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90Oy1QWDdWeTJDX3ZsSmR2RGtMNEUxJnF1b3Q7IG5hbWU9JnF1b3Q756ysIDEg6aG1JnF1b3Q7Jmd0OzdWeE5rNkpJRVAwMUhNZWd2dmc0cW1OUDcyRmlaNk0zZG5lT05KUktESUtEMk9yKytpMkdBaUVMSGV3VlVKeExCMlJCVWJ4ODlTb3pLVnNqMDlYK1UreXNsNThqandjYTFyMjlSajVxR052VUVIOVR3eUV6R0VRYUZySHZaU1owTkx6NC8zSnAxS1YxNjN0OFU3a3dpYUlnOGRkVm94dUZJWGVUaXMySjQyaFh2V3dlQmRXbnJwMEZWd3d2cmhPbzFyOTlMMWxtVmd1YlIvc3o5eGZML01uSXNMT1dsWk5mTE45a3MzUzhhRmN5a1psR3BuRVVKZG5SYWovbFFZcGRqa3QyMzlPSjFtSmdNUStUSmpkTUVNSnU4TjIydmo5UGQzK0diKzduUDM3L3dMSmUzcHhnSzE5WURqWTU1QWpFMFRiMGVOb0owc2hrdC9RVC9ySjIzTFIxSjF3dWJNdGtGY2ptdVI4RTB5aUk0aC8za3ZtY0c2NHI3SnNranI3eFVvdG4ycSs2WHJUazJBcFVKbkpJUEU3NC91UzdvZ0pCd1R3ZXJYZ1NIOFFsOGdZcU1UL2taSkxudTZNTGpaeGh5NUw3aUNXTmpxVE5vdWo2aUt3NGtPQmVBTFRSTHRDZXc2MTVMZENHYS9IWGVWdEFJd3lRSmlyU3lLaERtclNGZE83WEV0Ui9mWmtxYUl0M1RoUzh3aWprQUZ4cEtrTWZoWWtVS2t6emM5bHgycDRDNmdzRkdRZitJaFMybGU5NWFlUEVrUVpYZ012ajZ6aUFBUHdSVnZIWGEvQ25yY0Z2WHNKMC9YS21NMjU1dEk3cEZuNGxobkVsWGhPN2lxdGR3MnRjZzZ2UkdxNldndXRzK25LSzFpWDhtakpjWWVkSkh0YzVyT3JTYTNpQU11QUJwbmlBMWpnQXQrWUFvampnbTdWSm43VDJQMng0TE41V3cwYVFvdithSGkzU0kyVGpFVEtza1Q1Q1Y5Vjdqc1E4TU90bWdXMll4TG5XTERDcXM2Q0l5a28rc0xzVWwxeExoaVV1eE94YlhMREs3WWNTRjJMMkxDNGlrS2dYbDFBa1ZLZGxCWTJLeGYydWhZWFVMSy9kQ3N0QTQzTnNnMVcwLy9nY3E0SE1IV280UWJTNk5OYWttQjFydVAxWUdrNUE2b24xbmpXY3FJbG44d0FSMzJXQVNDaVlCYmhuSFNlRENCQ2h1QlJscWQ3RWhUeFlnQWpGaFZoOWk4djdBa1I4cHdFaUZCWmFzN3gyS3l3dFY4cjdDaENwV1NYNkRRU0laQkFWUkdyZFdnV1JQRmdGa2NMY3ArOEtJbEVqOUtFSGlBemRXQVdSb2lHS1MvOFZSS29HM2c4bExyMVhFT21wenhQRERCQ2hzUFJlUWFScWdLN0E2bTZGeHVlbzh0QWJweHRVVWs0SHptYmp1MVZZQlJEeDRaK1VzU09XbjM0dHQzM2NTenBuWjRjS3VibW43R3NCMEdJOWNlSUZUODR0V0hxOUQwb1lzeHFNYzF2TUF5ZngzNnJqcUFOZVB1Rkw1SXNSSG5NQUMrWmd3SGViYUJ1N1hONTFkSi9Ta1YzdGg4SitNaHlVZm9SM25FUHBzblY2d2ViY2VNRmFaMVUyNUlpRHJNY2p4d3BJL3dmdEd1UWxuZENPNy8ya2RKczQrMXBxT2Q2VW5seE8xY3pWWjNESVgvdkdPYzJxVkdSUWpwcFN1aER0bk5OMk81eUdBeVo2RjV4dThESG12WnpHZ3lSMXRqZWhMMUliZ05Uc3ZhUkdvQ085SlZLRFRWTUU2ZWZIQldvaytZTFM3aVJvVUFXNWJCTDB5MlY2SXA2N0w0b1NFRXNvQ2RXVktNcGcvYmtUM1czd1pmYWVLSmQ5RE9xTGNrQTBHR1JLWTFXRWxJUGN2VmI0Q3VZSW9WMVFUaTJKM1RYbCtsVTVrREF4ODhZcHg4QStmY0xPTDhRVTlhQ0srYnYveXJDMGhobVczZWNjQU5SbDd5MGFJTUJOQnI5M1hhMXFBRGhOdXVCMGd5cjRJM0NhTnE2RTljcHBtQmdaTURGcVRPcWYxUit1SmV4Z0ZoTDQyelI0UFJoWEhqeTFPd253cjBsUTNqUDFNSlBnWjhuZ3RaVGRCTHU0dWdpb1dVMDllTVkwNjBrYlAya3pVN09wTnJaK1dLYmFaUHhKSWZ4Z1B0QWgwNnFnWDBoZm1hMUVaV3RySCtoWVRVSG50R2QrRzY1bkNQeDFiaTdFdlhtbXB1NXgyalBQdy9VTXcyUUU5c3kwTjJ2RTZmSEg3NW44SGYrREFKbjlCdz09Jmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI&#43;PGRlZnM&#43;PGZpbHRlciBpZD0iZHJvcFNoYWRvdyI&#43;PGZlR2F1c3NpYW5CbHVyIGluPSJTb3VyY2VBbHBoYSIgc3RkRGV2aWF0aW9uPSIxLjciIHJlc3VsdD0iYmx1ciIvPjxmZU9mZnNldCBpbj0iYmx1ciIgZHg9IjMiIGR5PSIzIiByZXN1bHQ9Im9mZnNldEJsdXIiLz48ZmVGbG9vZCBmbG9vZC1jb2xvcj0iIzNENDU3NCIgZmxvb2Qtb3BhY2l0eT0iMC40IiByZXN1bHQ9Im9mZnNldENvbG9yIi8&#43;PGZlQ29tcG9zaXRlIGluPSJvZmZzZXRDb2xvciIgaW4yPSJvZmZzZXRCbHVyIiBvcGVyYXRvcj0iaW4iIHJlc3VsdD0ib2Zmc2V0Qmx1ciIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9Im9mZnNldEJsdXIiLz48L2ZpbHRlcj48L2RlZnM&#43;PGcgZmlsdGVyPSJ1cmwoI2Ryb3BTaGFkb3cpIj48cmVjdCB4PSIxMCIgeT0iMSIgd2lkdGg9IjYxMCIgaGVpZ2h0PSIzODAiIHJ4PSI1NyIgcnk9IjU3IiBmaWxsPSIjZmZlNmNjIiBzdHJva2U9IiNkNzliMDAiIHN0cm9rZS13aWR0aD0iMiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cmVjdCB4PSI5MCIgeT0iMzEiIHdpZHRoPSIxNjAiIGhlaWdodD0iMzMwIiByeD0iMjQiIHJ5PSIyNCIgZmlsbD0iI2RhZThmYyIgc3Ryb2tlPSIjNmM4ZWJmIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjUuNSwxOS41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI0OSIgaGVpZ2h0PSIyNiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDI0cHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdoaXRlLXNwYWNlOiBub3dyYXA7IGZvbnQtd2VpZ2h0OiBib2xkOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0OyI&#43;VlBDPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjI1IiB5PSIyNSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIyNHB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIiBmb250LXdlaWdodD0iYm9sZCI&#43;VlBDPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxMDkiIHk9IjkxIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZDVlOGQ0IiBzdHJva2U9IiM4MmIzNjYiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIyLjUsOTkuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogMjZweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPkVDUzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMiIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;RUNTPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxMzkiIHk9IjExMSIgd2lkdGg9IjkwIiBoZWlnaHQ9IjQwIiByeD0iNiIgcnk9IjYiIGZpbGw9IiNlMWQ1ZTciIHN0cm9rZT0iIzk2NzNhNiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNDUuNSwxMTcuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNzYiIGhlaWdodD0iMjYiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNzZweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPms4cyBhcGktc2VydmVyPGJyIC8&#43;MTkyLjE2OC4wLjE8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMzgiIHk9IjE5IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPms4cyBhcGktc2VydmVyJmx0O2JyJmd0OzE5Mi4xNjguMC4xPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxMDkiIHk9IjI3MSIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI2MCIgZmlsbD0iI2Q1ZThkNCIgc3Ryb2tlPSIjODJiMzY2IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDEyMi41LDI3OS41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyNnB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;RUNTPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjEyIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5FQ1M8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjEzOSIgeT0iMjkxIiB3aWR0aD0iOTAiIGhlaWdodD0iNDAiIHJ4PSI2IiByeT0iNiIgZmlsbD0iI2UxZDVlNyIgc3Ryb2tlPSIjOTY3M2E2IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDE0NS41LDI5Ny41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI3NiIgaGVpZ2h0PSIyNiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA3OHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;azhzIG5vZGU8YnIgLz4xOTIuMTY4LjEuMTAwPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjM4IiB5PSIxOSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5rOHMgbm9kZSZsdDticiZndDsxOTIuMTY4LjEuMTAwPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIyNjUiIHk9IjMxIiB3aWR0aD0iMTYwIiBoZWlnaHQ9IjMzMCIgcng9IjI0IiByeT0iMjQiIGZpbGw9IiNkYWU4ZmMiIHN0cm9rZT0iIzZjOGViZiIgc3Ryb2tlLXdpZHRoPSIyIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxyZWN0IHg9IjI4NCIgeT0iMTAxIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZDVlOGQ0IiBzdHJva2U9IiM4MmIzNjYiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMjk3LjUsMTA5LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjI0IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDI2cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5FQ1M8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMTIiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPkVDUzwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iMzE0IiB5PSIxMjEiIHdpZHRoPSI5MCIgaGVpZ2h0PSI0MCIgcng9IjYiIHJ5PSI2IiBmaWxsPSIjZTFkNWU3IiBzdHJva2U9IiM5NjczYTYiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzIwLjUsMTI3LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9Ijc2IiBoZWlnaHQ9IjI2IiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDc2cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij5rOHMgYXBpLXNlcnZlcjxiciAvPjE5Mi4xNjguMi4xPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjM4IiB5PSIxOSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5rOHMgYXBpLXNlcnZlciZsdDticiZndDsxOTIuMTY4LjIuMTwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iMjg0IiB5PSIyODEiIHdpZHRoPSIxMjAiIGhlaWdodD0iNjAiIGZpbGw9IiNkNWU4ZDQiIHN0cm9rZT0iIzgyYjM2NiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyOTcuNSwyODkuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogMjZweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPkVDUzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMiIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;RUNTPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIzMTQiIHk9IjMwMSIgd2lkdGg9IjkwIiBoZWlnaHQ9IjQwIiByeD0iNiIgcnk9IjYiIGZpbGw9IiNlMWQ1ZTciIHN0cm9rZT0iIzk2NzNhNiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMjAuNSwzMDcuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNzYiIGhlaWdodD0iMjYiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNzhweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPms4cyBub2RlPGJyIC8&#43;MTkyLjE2OC4yLjEwMDwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIzOCIgeT0iMTkiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;azhzIG5vZGUmbHQ7YnImZ3Q7MTkyLjE2OC4yLjEwMDwvdGV4dD48L3N3aXRjaD48L2c&#43;PHJlY3QgeD0iNDQwIiB5PSIzMSIgd2lkdGg9IjE2MCIgaGVpZ2h0PSIzMzAiIHJ4PSIyNCIgcnk9IjI0IiBmaWxsPSIjZGFlOGZjIiBzdHJva2U9IiM2YzhlYmYiIHN0cm9rZS13aWR0aD0iMiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cmVjdCB4PSI0NTkiIHk9IjkxIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjYwIiBmaWxsPSIjZDVlOGQ0IiBzdHJva2U9IiM4MmIzNjYiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNDcyLjUsOTkuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogMjZweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPkVDUzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIxMiIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;RUNTPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSI0ODkiIHk9IjExMSIgd2lkdGg9IjkwIiBoZWlnaHQ9IjQwIiByeD0iNiIgcnk9IjYiIGZpbGw9IiNlMWQ1ZTciIHN0cm9rZT0iIzk2NzNhNiIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSg0OTUuNSwxMTcuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNzYiIGhlaWdodD0iMjYiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNzZweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPms4cyBhcGktc2VydmVyPGJyIC8&#43;MTkyLjE2OC4yLjE8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMzgiIHk9IjE5IiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPms4cyBhcGktc2VydmVyJmx0O2JyJmd0OzE5Mi4xNjguMi4xPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSI0NTkiIHk9IjI3MSIgd2lkdGg9IjEyMCIgaGVpZ2h0PSI2MCIgZmlsbD0iI2Q1ZThkNCIgc3Ryb2tlPSIjODJiMzY2IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ3Mi41LDI3OS41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyNnB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;RUNTPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjEyIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5FQ1M8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjQ4OSIgeT0iMjkxIiB3aWR0aD0iOTAiIGhlaWdodD0iNDAiIHJ4PSI2IiByeT0iNiIgZmlsbD0iI2UxZDVlNyIgc3Ryb2tlPSIjOTY3M2E2IiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5NS41LDI5Ny41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI3NiIgaGVpZ2h0PSIyNiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA3OHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;azhzIG5vZGU8YnIgLz4xOTIuMTY4LjIuMTAwPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjM4IiB5PSIxOSIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5rOHMgbm9kZSZsdDticiZndDsxOTIuMTY4LjIuMTAwPC90ZXh0Pjwvc3dpdGNoPjwvZz48cGF0aCBkPSJNIDM1MCAyODEgUSAzNTkgMTgxIDM1OSAxNjcuMzciIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMzU5IDE2Mi4xMiBMIDM2Mi41IDE2OS4xMiBMIDM1OSAxNjcuMzcgTCAzNTUuNSAxNjkuMTIgWiIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAxNjkgMjcxIFEgMjIwIDIwMSAzNTIuODggMTYyLjc2IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDM1Ny45MyAxNjEuMzEgTCAzNTIuMTcgMTY2LjYxIEwgMzUyLjg4IDE2Mi43NiBMIDM1MC4yMyAxNTkuODggWiIgZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PHBhdGggZD0iTSAxNjkgMjcxIFEgMjAwIDIxMSAxNzAgMjAxIFEgMTQwIDE5MSAxNTguOTMgMTU2LjU4IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDE2MS40NiAxNTEuOTggTCAxNjEuMTUgMTU5LjggTCAxNTguOTMgMTU2LjU4IEwgMTU1LjAyIDE1Ni40MyBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDUxOSAyNzEgUSA0OTAgMjAxIDM2Ni4wOSAxNjIuODciIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMzYxLjA3IDE2MS4zMyBMIDM2OC43OSAxNjAuMDQgTCAzNjYuMDkgMTYyLjg3IEwgMzY2LjczIDE2Ni43MyBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDM0NCAyODEgUSAzMzAgMjQxIDE2NS42MyAxNTMuOTgiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMTYwLjk5IDE1MS41MiBMIDE2OC44MSAxNTEuNzEgTCAxNjUuNjMgMTUzLjk4IEwgMTY1LjU0IDE1Ny44OSBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDUxOSAyNzEgUSA1MTAgMjUxIDQ0NSAyMjYgUSAzODAgMjAxIDE2Ni4yMSAxNTIuNDEiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gMTYxLjA5IDE1MS4yNSBMIDE2OC42OSAxNDkuMzkgTCAxNjYuMjEgMTUyLjQxIEwgMTY3LjE0IDE1Ni4yMSBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDE2OSAyNzEgUSAzNTAgMjMxIDUyOC4xNiAxNTMuNTQiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gNTMyLjk3IDE1MS40NSBMIDUyNy45NSAxNTcuNDUgTCA1MjguMTYgMTUzLjU0IEwgNTI1LjE2IDE1MS4wMyBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDUxOSAyNzEgUSA1NjAgMjIxIDU0MCAxOTYgUSA1MjAgMTcxIDUzMC4zNSAxNTYuMjIiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gNTMzLjM2IDE1MS45MiBMIDUzMi4yMSAxNTkuNjYgTCA1MzAuMzUgMTU2LjIyIEwgNTI2LjQ4IDE1NS42NCBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48cGF0aCBkPSJNIDM0NCAyODEgUSAzNDQgMjQxIDUyOC4yNCAxNTMuNzMiIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxwYXRoIGQ9Ik0gNTMyLjk5IDE1MS40OCBMIDUyOC4xNiAxNTcuNjQgTCA1MjguMjQgMTUzLjczIEwgNTI1LjE3IDE1MS4zMSBaIiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNTEuNSw1NC41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI0NSIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA0N3B4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;5Y&#43;v55So5Yy6RzwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyMyIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;5Y&#43;v55So5Yy6RzwvdGV4dD48L3N3aXRjaD48L2c&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE2LjUsNTYuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iMzkiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNDFweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPuWPr&#43;eUqOWMukk8L2Rpdj48L2Rpdj48L2ZvcmVpZ25PYmplY3Q&#43;PHRleHQgeD0iMjAiIHk9IjEyIiBmaWxsPSIjMDAwMDAwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LXNpemU9IjEycHgiIGZvbnQtZmFtaWx5PSJIZWx2ZXRpY2EiPuWPr&#43;eUqOWMukk8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ5Ny41LDU0LjUpIj48c3dpdGNoPjxmb3JlaWduT2JqZWN0IHN0eWxlPSJvdmVyZmxvdzp2aXNpYmxlOyIgcG9pbnRlci1ldmVudHM9ImFsbCIgd2lkdGg9IjQ1IiBoZWlnaHQ9IjEyIiByZXF1aXJlZEZlYXR1cmVzPSJodHRwOi8vd3d3LnczLm9yZy9UUi9TVkcxMS9mZWF0dXJlI0V4dGVuc2liaWxpdHkiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OiBpbmxpbmUtYmxvY2s7IGZvbnQtc2l6ZTogMTJweDsgZm9udC1mYW1pbHk6IEhlbHZldGljYTsgY29sb3I6IHJnYigwLCAwLCAwKTsgbGluZS1oZWlnaHQ6IDEuMjsgdmVydGljYWwtYWxpZ246IHRvcDsgd2lkdGg6IDQ1cHg7IHdoaXRlLXNwYWNlOiBub3dyYXA7IG92ZXJmbG93LXdyYXA6IG5vcm1hbDsgdGV4dC1hbGlnbjogY2VudGVyOyI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6aW5saW5lLWJsb2NrO3RleHQtYWxpZ246aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246aW5oZXJpdDt3aGl0ZS1zcGFjZTpub3JtYWw7Ij7lj6/nlKjljLpIPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjIzIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj7lj6/nlKjljLpIPC90ZXh0Pjwvc3dpdGNoPjwvZz48L2c&#43;PC9zdmc&#43;" />   
    
需要为docker和etcd配备单独的云盘

        <img class="mx-auto" alt="" src="data:image/svg&#43;xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHdpZHRoPSIzMjciIGhlaWdodD0iMTU3IiB2aWV3Qm94PSItMC41IC0wLjUgMzI3IDE1NyIgY29udGVudD0iJmx0O214ZmlsZSBtb2RpZmllZD0mcXVvdDsyMDE5LTA3LTE3VDEwOjM2OjA5LjIzM1omcXVvdDsgaG9zdD0mcXVvdDsmcXVvdDsgYWdlbnQ9JnF1b3Q7TW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTRfNCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgZHJhdy5pby8xMC45LjUgQ2hyb21lLzczLjAuMzY4My4xMjEgRWxlY3Ryb24vNS4wLjYgU2FmYXJpLzUzNy4zNiZxdW90OyBldGFnPSZxdW90O1F5eUpIWjVqYkUwVVJfSTRUeWZxJnF1b3Q7IHZlcnNpb249JnF1b3Q7MTAuOS41JnF1b3Q7IHR5cGU9JnF1b3Q7ZGV2aWNlJnF1b3Q7Jmd0OyZsdDtkaWFncmFtIGlkPSZxdW90O2QxVFhWTVV4OVF1OXptWHhUa1ZMJnF1b3Q7IG5hbWU9JnF1b3Q756ysIDEg6aG1JnF1b3Q7Jmd0OzFaWk5iNk13RUVCL2pZK1ZzQjJnSEF1aDdhVXJyVGprN01WVGNHdHc1RGdsMlYrL1pqRWh4SW5VU2h0bGU3SHdtOEVmYjBZQ1JMTm05NlRadW41UkhDUWlBZDhodWtTRUpJdklqajNZRHlDaURsUmE4QUhoQ1JUaU56Z1lPTG9WSERhelJLT1VOR0k5aDZWcVd5ak5qREd0VlRkUGUxVnl2dXVhVmVDQm9tVFNweXZCVFQzUWV4SlAvQmxFVlk4NzR5Z1pJZzBiazkxTk5qWGpxanRDTkVjMDAwcVo0YW5aWlNCN2Q2T1g0YjNIQzlIRHdUUzA1ak12NURHczFJKzNvR3BYZTMzMy9MT0xDYmx6cTN3d3VYVVhkb2MxKzlHQVZ0dVdRNzhJUmpUdGFtR2dXTE95ajNhMjVKYlZwcEV1N0pZRGJXQjM4Wno0Y0h2Yk5hQWFNSHB2VThhV2NiNWN3NURBemJ0SlB4MmQxc2ZxUXdlWkszbDFXSHF5WWgrY21DOUlJcDZrUENzOFQvYkdaaTVqWTdSNmgweEpwUzFwVldzejAxY2g1UWxpVWxTdG5aYldFRmllOXY2RTdjRUhGMmdFNS8wMlorMVA5UW4rVFFFd09ha0E5aXV3T0ZNQWNpMy85RXlUUG40d2JVY3BmdG1ScS9MZGlydDE1M3JpUWw4Y1B0ZTZOTHlTdVlWbnJpaVdLRitnOUFFbEdPVXhTbEtVM1A5LzVwTHd4dWJDeXowSHB1UTNOMGJpMDE3RE56WVdmWk5lODh3bDBkWE0yZW4wZ2Y4Yk8vcExvdmtmJmx0Oy9kaWFncmFtJmd0OyZsdDsvbXhmaWxlJmd0OyI&#43;PGRlZnM&#43;PGZpbHRlciBpZD0iZHJvcFNoYWRvdyI&#43;PGZlR2F1c3NpYW5CbHVyIGluPSJTb3VyY2VBbHBoYSIgc3RkRGV2aWF0aW9uPSIxLjciIHJlc3VsdD0iYmx1ciIvPjxmZU9mZnNldCBpbj0iYmx1ciIgZHg9IjMiIGR5PSIzIiByZXN1bHQ9Im9mZnNldEJsdXIiLz48ZmVGbG9vZCBmbG9vZC1jb2xvcj0iIzNENDU3NCIgZmxvb2Qtb3BhY2l0eT0iMC40IiByZXN1bHQ9Im9mZnNldENvbG9yIi8&#43;PGZlQ29tcG9zaXRlIGluPSJvZmZzZXRDb2xvciIgaW4yPSJvZmZzZXRCbHVyIiBvcGVyYXRvcj0iaW4iIHJlc3VsdD0ib2Zmc2V0Qmx1ciIvPjxmZUJsZW5kIGluPSJTb3VyY2VHcmFwaGljIiBpbjI9Im9mZnNldEJsdXIiLz48L2ZpbHRlcj48L2RlZnM&#43;PGcgZmlsdGVyPSJ1cmwoI2Ryb3BTaGFkb3cpIj48cmVjdCB4PSIwIiB5PSIwIiB3aWR0aD0iMzIwIiBoZWlnaHQ9IjE1MCIgcng9IjIyLjUiIHJ5PSIyMi41IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzcuNSwxMy41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSIyNCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiAyNnB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;RUNTPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjEyIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5FQ1M8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjMwIiB5PSI1MCIgd2lkdGg9IjEyMCIgaGVpZ2h0PSIzNSIgcng9IjUuMjUiIHJ5PSI1LjI1IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNTIuNSw2MS41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI3NCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA3NnB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;L3Zhci9saWIvZG9ja2VyPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjM3IiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4vdmFyL2xpYi9kb2NrZXI8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjMwIiB5PSI5NSIgd2lkdGg9IjEyMCIgaGVpZ2h0PSIzNSIgcng9IjUuMjUiIHJ5PSI1LjI1IiBmaWxsPSIjZmZmZmZmIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50ZXItZXZlbnRzPSJub25lIi8&#43;PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNjUuNSwxMDYuNSkiPjxzd2l0Y2g&#43;PGZvcmVpZ25PYmplY3Qgc3R5bGU9Im92ZXJmbG93OnZpc2libGU7IiBwb2ludGVyLWV2ZW50cz0iYWxsIiB3aWR0aD0iNDgiIGhlaWdodD0iMTIiIHJlcXVpcmVkRmVhdHVyZXM9Imh0dHA6Ly93d3cudzMub3JnL1RSL1NWRzExL2ZlYXR1cmUjRXh0ZW5zaWJpbGl0eSI&#43;PGRpdiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbCIgc3R5bGU9ImRpc3BsYXk6IGlubGluZS1ibG9jazsgZm9udC1zaXplOiAxMnB4OyBmb250LWZhbWlseTogSGVsdmV0aWNhOyBjb2xvcjogcmdiKDAsIDAsIDApOyBsaW5lLWhlaWdodDogMS4yOyB2ZXJ0aWNhbC1hbGlnbjogdG9wOyB3aWR0aDogNTBweDsgd2hpdGUtc3BhY2U6IG5vd3JhcDsgb3ZlcmZsb3ctd3JhcDogbm9ybWFsOyB0ZXh0LWFsaWduOiBjZW50ZXI7Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTppbmxpbmUtYmxvY2s7dGV4dC1hbGlnbjppbmhlcml0O3RleHQtZGVjb3JhdGlvbjppbmhlcml0O3doaXRlLXNwYWNlOm5vcm1hbDsiPlNTROS6keebmDwvZGl2PjwvZGl2PjwvZm9yZWlnbk9iamVjdD48dGV4dCB4PSIyNCIgeT0iMTIiIGZpbGw9IiMwMDAwMDAiIHRleHQtYW5jaG9yPSJtaWRkbGUiIGZvbnQtc2l6ZT0iMTJweCIgZm9udC1mYW1pbHk9IkhlbHZldGljYSI&#43;U1NE5LqR55uYPC90ZXh0Pjwvc3dpdGNoPjwvZz48cmVjdCB4PSIxODAiIHk9IjUxIiB3aWR0aD0iMTIwIiBoZWlnaHQ9IjM1IiByeD0iNS4yNSIgcnk9IjUuMjUiIGZpbGw9IiNmZmZmZmYiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRlci1ldmVudHM9Im5vbmUiLz48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyMTYuNSw2Mi41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI0NiIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA0OHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;L3Zhci9ldGNkPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjIzIiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj4vdmFyL2V0Y2Q8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjxyZWN0IHg9IjE4MCIgeT0iOTYiIHdpZHRoPSIxMjAiIGhlaWdodD0iMzUiIHJ4PSI1LjI1IiByeT0iNS4yNSIgZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludGVyLWV2ZW50cz0ibm9uZSIvPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDIxNS41LDEwNy41KSI&#43;PHN3aXRjaD48Zm9yZWlnbk9iamVjdCBzdHlsZT0ib3ZlcmZsb3c6dmlzaWJsZTsiIHBvaW50ZXItZXZlbnRzPSJhbGwiIHdpZHRoPSI0OCIgaGVpZ2h0PSIxMiIgcmVxdWlyZWRGZWF0dXJlcz0iaHR0cDovL3d3dy53My5vcmcvVFIvU1ZHMTEvZmVhdHVyZSNFeHRlbnNpYmlsaXR5Ij48ZGl2IHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sIiBzdHlsZT0iZGlzcGxheTogaW5saW5lLWJsb2NrOyBmb250LXNpemU6IDEycHg7IGZvbnQtZmFtaWx5OiBIZWx2ZXRpY2E7IGNvbG9yOiByZ2IoMCwgMCwgMCk7IGxpbmUtaGVpZ2h0OiAxLjI7IHZlcnRpY2FsLWFsaWduOiB0b3A7IHdpZHRoOiA1MHB4OyB3aGl0ZS1zcGFjZTogbm93cmFwOyBvdmVyZmxvdy13cmFwOiBub3JtYWw7IHRleHQtYWxpZ246IGNlbnRlcjsiPjxkaXYgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiIHN0eWxlPSJkaXNwbGF5OmlubGluZS1ibG9jazt0ZXh0LWFsaWduOmluaGVyaXQ7dGV4dC1kZWNvcmF0aW9uOmluaGVyaXQ7d2hpdGUtc3BhY2U6bm9ybWFsOyI&#43;U1NE5LqR55uYPC9kaXY&#43;PC9kaXY&#43;PC9mb3JlaWduT2JqZWN0Pjx0ZXh0IHg9IjI0IiB5PSIxMiIgZmlsbD0iIzAwMDAwMCIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZm9udC1zaXplPSIxMnB4IiBmb250LWZhbWlseT0iSGVsdmV0aWNhIj5TU0TkupHnm5g8L3RleHQ&#43;PC9zd2l0Y2g&#43;PC9nPjwvZz48L3N2Zz4=" />   
    </p>
<h1 id="节点清单">节点清单</h1>
<table>
<thead>
<tr>
<th>ip</th>
<th>hostname</th>
<th>OS</th>
<th>kernel version</th>
</tr>
</thead>
<tbody>
<tr>
<td>127.0.0.1</td>
<td>server.k8s.local</td>
<td>Ubuntu 18.04</td>
<td>4.19.11-041911-generic</td>
</tr>
<tr>
<td>192.168.0.201</td>
<td>server1.k8s.local</td>
<td>Ubuntu 18.04</td>
<td>4.19.11-041911-generic</td>
</tr>
<tr>
<td>192.168.0.202</td>
<td>server2.k8s.local</td>
<td>Ubuntu 18.04</td>
<td>4.19.11-041911-generic</td>
</tr>
<tr>
<td>192.168.0.203</td>
<td>server3.k8s.local</td>
<td>Ubuntu 18.04</td>
<td>4.19.11-041911-generic</td>
</tr>
</tbody>
</table>
<h1 id="制作一个base镜像">制作一个base镜像</h1>
<p>制作一个base镜像安装和修改通用组件，方便以后的节点部署。</p>
<ul>
<li>修改node的hosts文件
如果你使用自己的域名我建议将如下配置配到你的域名管理中。
<!-- raw HTML omitted -->注意：<!-- raw HTML omitted -->如你使用我这里的域名你需要将此信息写入到机器中的每一台node中（包括master和node）</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat &gt;&gt; /etc/hosts <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">127.0.0.1 server.k8s.local
</span></span></span><span style="display:flex;"><span><span style="color:#d14">192.168.0.1 server1.k8s.local
</span></span></span><span style="display:flex;"><span><span style="color:#d14">192.168.1.1 server2.k8s.local
</span></span></span><span style="display:flex;"><span><span style="color:#d14">192.168.2.1 server3.k8s.local
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="禁用">禁用</h1>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#https://linuxconfig.org/how-to-disable-ipv6-address-on-ubuntu-18-04-bionic-beaver-linux</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 编辑grub</span>
</span></span><span style="display:flex;"><span>➜ vim /etc/default/grub
</span></span><span style="display:flex;"><span>FROM:
</span></span><span style="display:flex;"><span><span style="color:#008080">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GRUB_CMDLINE_LINUX</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>TO:
</span></span><span style="display:flex;"><span><span style="color:#008080">GRUB_CMDLINE_LINUX_DEFAULT</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;ipv6.disable=1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">GRUB_CMDLINE_LINUX</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;ipv6.disable=1&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 更新grub</span>
</span></span><span style="display:flex;"><span>➜ update-grub
</span></span></code></pre></td></tr></table>
</div>
</div><p>#时区问题</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime
</span></span></code></pre></td></tr></table>
</div>
</div><p>#DNS 问题</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>systemctl disable systemd-resolved
</span></span><span style="display:flex;"><span>rm -rf /etc/resolv.conf
</span></span><span style="display:flex;"><span>touch /etc/resolv.conf
</span></span><span style="display:flex;"><span><span style="color:#0086b3">echo</span> <span style="color:#d14">&#39;nameserver 114.114.114.114&#39;</span> &gt; /etc/resolv.conf
</span></span><span style="display:flex;"><span><span style="color:#0086b3">echo</span> <span style="color:#d14">&#39;100.100.2.148 mirrors.cloud.aliyuncs.com&#39;</span> &gt;&gt; /etc/hosts
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="为什么要升级内核">为什么要升级内核</h1>
<p>本文中所使用到的OS为<code>Ubuntu 18.04</code>，用户均为<code>root</code>用户。升级内核为必须条件。<!-- raw HTML omitted -->
在低版本的内核中会出现一下很让人恼火的BUG，时不时来一下，发作时候会导致整个OS Hang住无法执行任何命令。
现象如下：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kernel:unregister_netdevice: waiting <span style="color:#000;font-weight:bold">for</span> lo to become free. Usage <span style="color:#008080">count</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#099">1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>关于这个Bug，你可以从一下地方追踪到：
<a href="https://github.com/moby/moby/issues/5618">https://github.com/moby/moby/issues/5618</a>
<a href="https://github.com/coreos/bugs/issues/254">https://github.com/coreos/bugs/issues/254</a></p>
<p>还有老哥放出了重现这个bug的代码:<a href="https://github.com/fho/docker-samba-loop">https://github.com/fho/docker-samba-loop</a></p>
<p>而根据我实际的实验（采坑）下来,这个问题我花费了差不多1个多月的时间先后尝试了内核版本3.10，4.4，4.9，4.12，4.14，4.15版本，均会不同程度的复现上述Bug，而一旦触发并无他法，只能重启（然后祈祷不要再次触发）。
实在是让人寝食难安，睡不踏实，直到我遇到了内核4.17，升级完毕之后，从6月到现在，没有复现过。似乎可以认为该BUG已经修复了，故而建议升级内核到4.17+。</p>
<h2 id="我应该如何选择master节点的配置">我应该如何选择master节点的配置</h2>
<p>关于这个问题在<a href="https://github.com/kubernetes/kubernetes">kubernetes</a>项目中，提供了一个配置的<a href="https://github.com/kubernetes/kubernetes/blob/master/cluster/gce/config-common.sh">脚本</a>(里面包括有推荐的vCPU核心数，磁盘大小，podip段，svcip段等等。)</p>
<h1 id="机器环境">机器环境</h1>
<h2 id="升级内核">升级内核</h2>
<p>你可以从Linux内核<a href="https://www.kernel.org/">官网</a>了解到最新发布的内核版本。<!-- raw HTML omitted -->
我们这里升级到当前最新的<a href="https://kernel.ubuntu.com/~kernel-ppa/mainline/v4.19.11/">4.19.11</a>版本的内核，一下为升级到该内核版本需要的文件。<!-- raw HTML omitted -->
<a href="https://kernel.ubuntu.com/~kernel-ppa/mainline/v4.19.11/linux-headers-4.19.11-041911_4.19.11-041911.201812191931_all.deb">linux-headers-4.19.11-041911_4.19.11-041911.201812191931_all.deb</a><!-- raw HTML omitted -->
<a href="https://kernel.ubuntu.com/~kernel-ppa/mainline/v4.19.11/linux-image-unsigned-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb">linux-image-unsigned-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb</a><!-- raw HTML omitted -->
<a href="https://kernel.ubuntu.com/~kernel-ppa/mainline/v4.19.11/linux-modules-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb">linux-modules-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb</a><!-- raw HTML omitted -->
以上三个内核相关文件下载到本地。如我这里存放在<code>~</code>目录下。执行以下命令完成内核的安装。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ dpkg -i ~/*.deb
</span></span><span style="display:flex;"><span>正在选中未选择的软件包 linux-headers-4.19.11-041911。
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span>正在读取数据库 ... 系统当前共安装有 <span style="color:#099">60576</span> 个文件和目录。<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>正准备解包 linux-headers-4.19.11-041911_4.19.11-041911.201812191931_all.deb  ...
</span></span><span style="display:flex;"><span>正在解包 linux-headers-4.19.11-041911 <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>正在选中未选择的软件包 linux-image-unsigned-4.19.11-041911-generic。
</span></span><span style="display:flex;"><span>正准备解包 linux-image-unsigned-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb  ...
</span></span><span style="display:flex;"><span>正在解包 linux-image-unsigned-4.19.11-041911-generic <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>正在选中未选择的软件包 linux-modules-4.19.11-041911-generic。
</span></span><span style="display:flex;"><span>正准备解包 linux-modules-4.19.11-041911-generic_4.19.11-041911.201812191931_amd64.deb  ...
</span></span><span style="display:flex;"><span>正在解包 linux-modules-4.19.11-041911-generic <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>正在设置 linux-headers-4.19.11-041911 <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>正在设置 linux-modules-4.19.11-041911-generic <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>正在设置 linux-image-unsigned-4.19.11-041911-generic <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> ...
</span></span><span style="display:flex;"><span>I: /vmlinuz.old is now a symlink to boot/vmlinuz-4.4.0-131-generic
</span></span><span style="display:flex;"><span>I: /initrd.img.old is now a symlink to boot/initrd.img-4.4.0-131-generic
</span></span><span style="display:flex;"><span>I: /vmlinuz is now a symlink to boot/vmlinuz-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>I: /initrd.img is now a symlink to boot/initrd.img-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>正在处理用于 linux-image-unsigned-4.19.11-041911-generic <span style="color:#000;font-weight:bold">(</span>4.19.11-041911.201812191931<span style="color:#000;font-weight:bold">)</span> 的触发器 ...
</span></span><span style="display:flex;"><span>/etc/kernel/postinst.d/initramfs-tools:
</span></span><span style="display:flex;"><span>update-initramfs: Generating /boot/initrd.img-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>W: mdadm: /etc/mdadm/mdadm.conf defines no arrays.
</span></span><span style="display:flex;"><span>/etc/kernel/postinst.d/x-grub-legacy-ec2:
</span></span><span style="display:flex;"><span>Searching <span style="color:#000;font-weight:bold">for</span> GRUB installation directory ... found: /boot/grub
</span></span><span style="display:flex;"><span>Searching <span style="color:#000;font-weight:bold">for</span> default file ... found: /boot/grub/default
</span></span><span style="display:flex;"><span>Testing <span style="color:#000;font-weight:bold">for</span> an existing GRUB menu.lst file ... found: /boot/grub/menu.lst
</span></span><span style="display:flex;"><span>Searching <span style="color:#000;font-weight:bold">for</span> splash image ... none found, skipping ...
</span></span><span style="display:flex;"><span>Found kernel: /boot/vmlinuz-4.4.0-131-generic
</span></span><span style="display:flex;"><span>Found kernel: /boot/vmlinuz-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>Found kernel: /boot/vmlinuz-4.4.0-131-generic
</span></span><span style="display:flex;"><span>Replacing config file /run/grub/menu.lst with new version
</span></span><span style="display:flex;"><span>Updating /boot/grub/menu.lst ... <span style="color:#000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>/etc/kernel/postinst.d/zz-update-grub:
</span></span><span style="display:flex;"><span>Generating grub configuration file ...
</span></span><span style="display:flex;"><span>Found linux image: /boot/vmlinuz-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>Found initrd image: /boot/initrd.img-4.19.11-041911-generic
</span></span><span style="display:flex;"><span>Found linux image: /boot/vmlinuz-4.4.0-131-generic
</span></span><span style="display:flex;"><span>Found initrd image: /boot/initrd.img-4.4.0-131-generic
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">done</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>完成安装后，reboot重启服务器。查看我们的最新内核版本。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  uname -a 
</span></span><span style="display:flex;"><span>Linux k8s 4.19.11-041911-generic <span style="color:#998;font-style:italic">#201812191931 SMP Wed Dec 19 19:33:33 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>清理老的内核(可选)。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 查看老的内核</span>
</span></span><span style="display:flex;"><span>➜ dpkg --list | grep linux
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 清理 老旧的4.4.0内核的相关</span>
</span></span><span style="display:flex;"><span>➜ apt purge linux*4.4.0* -y
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="启用ipvs相关内核module">启用IPVS相关内核module</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#0086b3">echo</span> &gt; /etc/modules-load.d/ipvs.conf
</span></span><span style="display:flex;"><span>➜ <span style="color:#008080">module</span><span style="color:#000;font-weight:bold">=(</span>ip_vs
</span></span><span style="display:flex;"><span>        ip_vs_rr
</span></span><span style="display:flex;"><span>        ip_vs_wrr
</span></span><span style="display:flex;"><span>        ip_vs_sh
</span></span><span style="display:flex;"><span>        ip_vs_lc
</span></span><span style="display:flex;"><span>        br_netfilter
</span></span><span style="display:flex;"><span>        nf_conntrack<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">for</span> kernel_module in <span style="color:#d14">${</span><span style="color:#008080">module</span>[@]<span style="color:#d14">}</span>;<span style="color:#000;font-weight:bold">do</span>
</span></span><span style="display:flex;"><span>    /sbin/modinfo -F filename <span style="color:#008080">$kernel_module</span> |&amp; grep -qv ERROR <span style="color:#000;font-weight:bold">&amp;&amp;</span> <span style="color:#0086b3">echo</span> <span style="color:#008080">$kernel_module</span> &gt;&gt; /etc/modules-load.d/ipvs.conf <span style="color:#000;font-weight:bold">||</span> :
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">done</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  如下输出表示加载成功</span>
</span></span><span style="display:flex;"><span>➜  lsmod | grep ip_vs
</span></span><span style="display:flex;"><span> ip_vs_sh               <span style="color:#099">16384</span>  <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span> ip_vs_wrr              <span style="color:#099">16384</span>  <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span> ip_vs_rr               <span style="color:#099">16384</span>  <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span> ip_vs                 <span style="color:#099">147456</span>  <span style="color:#099">6</span> ip_vs_rr,ip_vs_sh,ip_vs_wrr
</span></span><span style="display:flex;"><span> nf_conntrack          <span style="color:#099">143360</span>  <span style="color:#099">6</span> xt_conntrack,nf_nat,ipt_MASQUERADE,nf_nat_ipv4,nf_conntrack_netlink,ip_vs
</span></span><span style="display:flex;"><span> libcrc32c              <span style="color:#099">16384</span>  <span style="color:#099">5</span> nf_conntrack,nf_nat,btrfs,raid456,ip_vs
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="内核参数调整">内核参数调整</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ cat &gt; /etc/sysctl.conf <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14"># https://github.com/moby/moby/issues/31208 
</span></span></span><span style="display:flex;"><span><span style="color:#d14"># ipvsadm -l --timout
</span></span></span><span style="display:flex;"><span><span style="color:#d14"># 修复ipvs模式下长连接timeout问题 小于900即可
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_keepalive_time = 800
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_keepalive_intvl = 30
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_keepalive_probes = 10
</span></span></span><span style="display:flex;"><span><span style="color:#d14">
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv6.conf.all.disable_ipv6 = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv6.conf.default.disable_ipv6 = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv6.conf.lo.disable_ipv6 = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.neigh.default.gc_stale_time = 120
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.conf.all.rp_filter = 0
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.conf.default.rp_filter = 0
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.conf.default.arp_announce = 2
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.conf.lo.arp_announce = 2
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.conf.all.arp_announce = 2
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.ip_forward = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_max_tw_buckets = 5000
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_syncookies = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_max_syn_backlog = 1024
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.ipv4.tcp_synack_retries = 2
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.bridge.bridge-nf-call-ip6tables = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.bridge.bridge-nf-call-iptables = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">fs.inotify.max_user_watches=89100
</span></span></span><span style="display:flex;"><span><span style="color:#d14">fs.file-max=52706963
</span></span></span><span style="display:flex;"><span><span style="color:#d14">fs.nr_open=52706963
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.bridge.bridge-nf-call-arptables = 1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">vm.swappiness = 0
</span></span></span><span style="display:flex;"><span><span style="color:#d14">vm.max_map_count=262144
</span></span></span><span style="display:flex;"><span><span style="color:#d14">net.core.somaxconn = 2048
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="禁用swap并关闭防火墙">禁用swap并关闭防火墙</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>swapoff -a 
</span></span><span style="display:flex;"><span>sysctl -w vm.swappiness<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span> 
</span></span><span style="display:flex;"><span>sed -ri <span style="color:#d14">&#39;/^[^#]*swap/s@^@#@&#39;</span> /etc/fstab
</span></span><span style="display:flex;"><span>systemctl disable --now ufw
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="安装必须软件">安装必须软件</h2>
<h2 id="配置镜像">配置镜像</h2>
<p>阿里云的镜像<a href="https://opsx.alibaba.com/mirror">仓库</a> <!-- raw HTML omitted -->
配置<code>Ubuntu 18.04</code></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ cat &gt; /etc/apt/sources.list <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="更新apt镜像源并升级相关软件">更新apt镜像源并升级相关软件</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt update <span style="color:#000;font-weight:bold">&amp;&amp;</span> apt upgrade 
</span></span><span style="display:flex;"><span>apt -y install ipvsadm ipset apt-transport-https 
</span></span><span style="display:flex;"><span>apt -y install ca-certificates curl software-properties-common apt-transport-https
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="安装docker-ce">安装Docker-ce</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># step 1: 安装GPG证书</span>
</span></span><span style="display:flex;"><span>curl -fsSL http://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Step 2: 写入软件源信息</span>
</span></span><span style="display:flex;"><span>add-apt-repository <span style="color:#d14">&#34;deb [arch=amd64] http://mirrors.aliyun.com/docker-ce/linux/ubuntu </span><span style="color:#000;font-weight:bold">$(</span>lsb_release -cs<span style="color:#000;font-weight:bold">)</span><span style="color:#d14"> stable&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># Step 3: 更新并安装 Docker-CE</span>
</span></span><span style="display:flex;"><span>apt-get -y update
</span></span><span style="display:flex;"><span>apt-get -y install docker-ce
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="配置docker">配置Docker</h2>
<p>这里推荐使用cgroupdriver 使用cgroupfs 不推荐使用systemd 这里有具体的<a href="https://github.com/kubernetes/kubernetes/issues/76531">讨论</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>touch /etc/docker/daemon.json
</span></span><span style="display:flex;"><span>cat &gt; /etc/docker/daemon.json <span style="color:#d14">&lt;&lt;EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">{
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;log-driver&#34;: &#34;json-file&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;exec-opts&#34;: [&#34;native.cgroupdriver=cgroupfs&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;log-opts&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;max-size&#34;: &#34;100m&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;max-file&#34;: &#34;3&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    },
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;live-restore&#34;: true,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;max-concurrent-downloads&#34;: 10,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;max-concurrent-uploads&#34;: 10,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;registry-mirrors&#34;: [&#34;https://xxx.mirror.aliyuncs.com&#34;],
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;storage-driver&#34;: &#34;overlay2&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;storage-opts&#34;: [
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &#34;overlay2.override_kernel_check=true&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    ]
</span></span></span><span style="display:flex;"><span><span style="color:#d14">}
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span><span style="display:flex;"><span>systemctl daemon-reload 
</span></span><span style="display:flex;"><span>systemctl restart docker
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="部署nginx-local-proxy">部署Nginx local Proxy</h1>
<h2 id="nginxconf">Nginx.conf</h2>
<p>本地nginx代理的主要主要是代理访问所有的master节点。nginx.conf 配置如下：
<a href="http://www.blogjava.net/yongboy/archive/2015/02/12/422893.html">reuseport</a></p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /etc/nginx
</span></span><span style="display:flex;"><span>cat &gt; /etc/nginx/nginx.conf <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">worker_processes auto;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">user root;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">events {
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    worker_connections  20240;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    use epoll;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">}
</span></span></span><span style="display:flex;"><span><span style="color:#d14">error_log /var/log/nginx_error.log info;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">
</span></span></span><span style="display:flex;"><span><span style="color:#d14">stream {
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    upstream kube-servers {
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        hash $remote_addr consistent;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        server server1.k8s.local:6443 weight=5 max_fails=1 fail_timeout=3s;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        server server2.k8s.local:6443 weight=5 max_fails=1 fail_timeout=3s;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        server server3.k8s.local:6443 weight=5 max_fails=1 fail_timeout=3s;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    }
</span></span></span><span style="display:flex;"><span><span style="color:#d14">
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    server {
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        listen 8443 reuseport;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        proxy_connect_timeout 3s;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        # 加大timeout
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        proxy_timeout 3000s;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">        proxy_pass kube-servers;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    }
</span></span></span><span style="display:flex;"><span><span style="color:#d14">}
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="启动nginx">启动Nginx</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ docker run --restart<span style="color:#000;font-weight:bold">=</span>always <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /etc/apt/sources.list:/etc/apt/sources.list <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /etc/nginx/nginx.conf:/etc/nginx/nginx.conf <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--name kps <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--net host <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-it <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-d <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>nginx
</span></span></code></pre></td></tr></table>
</div>
</div><p>注意：<!-- raw HTML omitted -->请确保每一台kubernetes机器中的机器都运行着此代理<!-- raw HTML omitted --></p>
<h1 id="部署etcd集群">部署ETCD集群</h1>
<p><a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/clustering.md">如何构建一个集群</a>
<a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/security.md">如何构建一个tls集群</a></p>
<p>关于ETCD要不要使用TLS？
首先TLS的目的是为了鉴权为了防止别人任意的连接上你的etcd集群。其实意思就是说如果你要放到公网上的ETCD集群，并开放端口，我建议你一定要用TLS。
如果你的ETCD集群跑在一个内网环境比如（VPC环境），而且你也不会开放ETCD端口，你的ETCD跑在防火墙之后，一个安全的局域网中，那么你用不用TLS，都行。</p>
<h2 id="font-colorred注意事项font"><!-- raw HTML omitted -->注意事项<!-- raw HTML omitted --></h2>
<ol>
<li><code>--auto-compaction-retention</code>
由于ETCD数据存储多版本数据，随着写入的主键增加历史版本需要定时清理，默认的历史数据是不会清理的，数据达到2G就不能写入，必须要清理压缩历史数据才能继续写入;所以根据业务需求，在上生产环境之前就提前确定，历史数据多长时间压缩一次;推荐一小时压缩一次数据这样可以极大的保证集群稳定，减少内存和磁盘占用</li>
<li><code>--max-request-bytes</code>
etcd Raft消息最大字节数，ETCD默认该值为1.5M; 但是很多业务场景发现同步数据的时候1.5M完全没法满足要求，所以提前确定初始值很重要;由于1.5M导致我们线上的业务无法写入元数据的问题，我们紧急升级之后把该值修改为默认32M，但是官方推荐的是10M，大家可以根据业务情况自己调整</li>
<li><code>--quota-backend-bytes</code>
ETCD db数据大小，默认是2G，当数据达到2G的时候就不允许写入，必须对历史数据进行压缩才能继续写入;参加1里面说的，我们启动的时候就应该提前确定大小，官方推荐是8G，这里我们也使用8G的配置</li>
</ol>
<p>&ndash;auto-compaction-retention=1 &ndash;max-request-bytes=&lsquo;33554432&rsquo; &ndash;quota-backend-bytes=&lsquo;8589934592&rsquo; \</p>
<h2 id="docker安装etcd">docker安装ETCD</h2>
<p>请依次在你规划好的etcd机器上运行即可。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /var/etcd
</span></span><span style="display:flex;"><span>docker rm etcd1 -f
</span></span><span style="display:flex;"><span>rm -rf /var/etcd/*
</span></span><span style="display:flex;"><span>docker run --restart<span style="color:#000;font-weight:bold">=</span>always --net host -it --name etcd1 -d <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /var/etcd:/var/etcd <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /etc/localtime:/etc/localtime <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>quay.io/coreos/etcd:v3.3.13 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>etcd --name etcd-s1 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--auto-compaction-retention <span style="color:#d14">&#34;1h&#34;</span> --max-request-bytes <span style="color:#d14">&#34;33554432&#34;</span> --quota-backend-bytes <span style="color:#d14">&#34;8589934592&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--data-dir<span style="color:#000;font-weight:bold">=</span>/var/etcd/etcd-data <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-client-urls http://0.0.0.0:2379 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-peer-urls http://0.0.0.0:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--initial-advertise-peer-urls http://server1.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--advertise-client-urls http://server1.k8s.local:2379,http://server1.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-token etcd-cluster <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster <span style="color:#d14">&#34;etcd-s1=http://server1.k8s.local:2380,etcd-s2=http://server2.k8s.local:2380,etcd-s3=http://server3.k8s.local:2380&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-state new
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>etcd2</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /var/etcd
</span></span><span style="display:flex;"><span>docker rm etcd2 -f
</span></span><span style="display:flex;"><span>rm -rf /var/etcd/*
</span></span><span style="display:flex;"><span>docker run --restart<span style="color:#000;font-weight:bold">=</span>always --net host -it --name etcd2 -d <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /var/etcd:/var/etcd <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /etc/localtime:/etc/localtime <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>quay.io/coreos/etcd:v3.3.13 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>etcd --name etcd-s2  <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--auto-compaction-retention <span style="color:#d14">&#34;1h&#34;</span> --max-request-bytes <span style="color:#d14">&#34;33554432&#34;</span> --quota-backend-bytes <span style="color:#d14">&#34;8589934592&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--data-dir<span style="color:#000;font-weight:bold">=</span>/var/etcd/etcd-data <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-client-urls http://0.0.0.0:2379 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-peer-urls http://0.0.0.0:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--initial-advertise-peer-urls http://server2.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--advertise-client-urls http://server2.k8s.local:2379,http://server2.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-token etcd-cluster <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster <span style="color:#d14">&#34;etcd-s1=http://server1.k8s.local:2380,etcd-s2=http://server2.k8s.local:2380,etcd-s3=http://server3.k8s.local:2380&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-state new
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>etcd3</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p /var/etcd
</span></span><span style="display:flex;"><span>docker rm etcd3 -f
</span></span><span style="display:flex;"><span>rm -rf /var/etcd/*
</span></span><span style="display:flex;"><span>docker run --restart<span style="color:#000;font-weight:bold">=</span>always --net host -it --name etcd3 -d <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /var/etcd:/var/etcd <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-v /etc/localtime:/etc/localtime <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>quay.io/coreos/etcd:v3.3.13 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>etcd --name etcd-s3 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--auto-compaction-retention <span style="color:#d14">&#34;1h&#34;</span> --max-request-bytes <span style="color:#d14">&#34;33554432&#34;</span> --quota-backend-bytes <span style="color:#d14">&#34;8589934592&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--data-dir<span style="color:#000;font-weight:bold">=</span>/var/etcd/etcd-data <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-client-urls http://0.0.0.0:2379 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--listen-peer-urls http://0.0.0.0:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--initial-advertise-peer-urls http://server3.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--advertise-client-urls http://server3.k8s.local:2379,http://server3.k8s.local:2380 <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-token etcd-cluster <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster <span style="color:#d14">&#34;etcd-s1=http://server1.k8s.local:2380,etcd-s2=http://server2.k8s.local:2380,etcd-s3=http://server3.k8s.local:2380&#34;</span> <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>-initial-cluster-state new
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 如何修复故障的ETCD节点</span>
</span></span><span style="display:flex;"><span>https://www.centos.bz/2018/06/etcd%E9%9B%86%E7%BE%A4%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/
</span></span></code></pre></td></tr></table>
</div>
</div><p>ETCDCTL_API=3 etcdctl &ndash;endpoints=http://server1.k8s.local:2379,http://server2.k8s.local:2379,http://server3.k8s.local:2379 endpoint health
ETCDCTL_API=3 etcdctl &ndash;endpoints=http://server1.k8s.local:2379,http://server2.k8s.local:2379,http://server3.k8s.local:2379 member list
ETCDCTL_API=3 etcdctl &ndash;endpoints=http://server1.k8s.local:2379,http://server2.k8s.local:2379,http://server3.k8s.local:2379 endpoint status &ndash;write-out=table</p>
<h1 id="首先从集群删除节点">首先从集群删除节点</h1>
<p>etcdctl &ndash;endpoints=http://server1.k8s.local:2379,http://192.168.0.202:2379,http://192.168.0.203:2379 member remove nodeid</p>
<h1 id="添加节点">添加节点</h1>
<p>etcdctl &ndash;endpoints=http://server1.k8s.local:2379,http://192.168.0.202:2379 member add etcd-s3 &ndash;peer-urls=&ldquo;<a href="http://server3.k8s.local:2380">http://server3.k8s.local:2380</a>&rdquo;</p>
<h1 id="将new修改为existing">将new修改为existing</h1>
<p>-initial-cluster-state existing</p>
<ul>
<li>检查</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ <span style="color:#008080">ETCDCTL_API</span><span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span> etcdctl  member list
</span></span><span style="display:flex;"><span>410feb26f4fa3c7f: <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span>etcd-s1 <span style="color:#008080">peerURLs</span><span style="color:#000;font-weight:bold">=</span>http://server1.k8s.local:2380 <span style="color:#008080">clientURLs</span><span style="color:#000;font-weight:bold">=</span>http://server1.k8s.local:2379,http://server1.k8s.local:2380
</span></span><span style="display:flex;"><span>56fa117fc503543c: <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span>etcd-s3 <span style="color:#008080">peerURLs</span><span style="color:#000;font-weight:bold">=</span>http://server3.k8s.local:2380 <span style="color:#008080">clientURLs</span><span style="color:#000;font-weight:bold">=</span>http://server3.k8s.local:2379,http://server3.k8s.local:2380
</span></span><span style="display:flex;"><span>bc4d900274366497: <span style="color:#008080">name</span><span style="color:#000;font-weight:bold">=</span>etcd-s2 <span style="color:#008080">peerURLs</span><span style="color:#000;font-weight:bold">=</span>http://server2.k8s.local:2380 <span style="color:#008080">clientURLs</span><span style="color:#000;font-weight:bold">=</span>http://server2.k8s.local:2379,http://server2.k8s.local:2380
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>➜ <span style="color:#008080">ETCDCTL_API</span><span style="color:#000;font-weight:bold">=</span><span style="color:#099">3</span> etcdctl cluster-health
</span></span><span style="display:flex;"><span>http://server1.k8s.local:2379 is healthy: successfully committed proposal: <span style="color:#008080">took</span> <span style="color:#000;font-weight:bold">=</span> 3.755356ms
</span></span><span style="display:flex;"><span>http://server3.k8s.local:2379 is healthy: successfully committed proposal: <span style="color:#008080">took</span> <span style="color:#000;font-weight:bold">=</span> 3.415338ms
</span></span><span style="display:flex;"><span>http://server2.k8s.local:2379 is healthy: successfully committed proposal: <span style="color:#008080">took</span> <span style="color:#000;font-weight:bold">=</span> 5.179934ms
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="部署master">部署Master</h1>
<h2 id="安装kubernetes基础组件">安装kubernetes基础组件</h2>
<h3 id="关于kubeadm自动签发的证书一年过期的问题">关于kubeadm自动签发的证书一年过期的问题</h3>
<p>你可以参考我的<a href="https://qingmu.io/2019/08/01/Hands-on-modification-of-the-validity-period-of-the-kubeam-generation-certificate/">这篇文章</a></p>
<h3 id="设置镜像源">设置镜像源</h3>
<p>同样使用国内的阿里云提供的<a href="https://opsx.alibaba.com/mirror">kubernetes镜像源</a>,加速基础组件的安装。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add -
</span></span><span style="display:flex;"><span>cat  &gt; /etc/apt/sources.list.d/kubernetes.list <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="安装kubeadm-kubelet-kubectl">安装<code>kubeadm kubelet kubectl</code></h3>
<p>如果你是自己手动编译的kubeadm的话记得替换下。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>apt-get update
</span></span><span style="display:flex;"><span>apt-get install kubeadm kubelet kubectl
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="设置kubelet的pause镜像">设置kubelet的pause镜像</h3>
<p>在Ubuntu中的kublet配置文件在<code>/etc/systemd/system/kubelet.service.d/10-kubeadm.conf</code>
关于为什么不使用kubeadm推荐的system做为cgroup-driver <a href="https://github.com/kubernetes/kubernetes/issues/76531">这里</a>有详细的讨论，我在使用systemd作为驱动时，遇到了同样的问题，以及kubelet极高的CPU使用。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat &gt; /etc/default/kubelet <span style="color:#d14">&lt;&lt; EOF
</span></span></span><span style="display:flex;"><span><span style="color:#d14">KUBELET_EXTRA_ARGS=&#34;--cgroup-driver=cgroupfs --serialize-image-pulls=false --image-pull-progress-deadline=30m --max-pods=300 --allow-privileged=true --pod-infra-container-image=freemanliu/pause:3.1&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">EOF</span>
</span></span><span style="display:flex;"><span>systemctl daemon-reload
</span></span><span style="display:flex;"><span>systemctl <span style="color:#0086b3">enable</span> kubelet <span style="color:#000;font-weight:bold">&amp;&amp;</span> systemctl restart kubelet
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="kubeadm-configyaml">Kubeadm-config.yaml</h2>
<p>自1.13.0之后的kubeadm的文件格式发生了比较大的变化
你可以使用一下命令查看到默认的yaml格式</p>
<ul>
<li>查看 ClusterConfiguration 的默认配置</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  kubeadm config print-default --api-objects ClusterConfiguration</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查看 KubeProxyConfiguration 的默认配置</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  kubeadm config print-default --api-objects KubeProxyConfiguration</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查看 KubeletConfiguration 的默认配置</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#  kubeadm config print-default --api-objects KubeletConfiguration</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># https://godoc.org/k8s.io/kubernetes/cmd/kubeadm/app/apis/kubeadm/v1beta1</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>kubeadm-config.yaml</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#    enable-admission-plugins: &#34;NamespaceLifecycle,LimitRanger,ServiceAccount,PersistentVolumeClaimResize,DefaultStorageClass,DefaultTolerationSeconds,NodeRestriction,MutatingAdmissionWebhook,ValidatingAdmissionWebhook,ResourceQuota,Priority&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic"># kubeadm init --config=kubeadm-config.yaml --experimental-upload-certs</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>kubeadm.k8s.io/v1beta1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>ClusterConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">kubernetesVersion</span>:<span style="color:#bbb"> </span>v1.14.4<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#useHyperKubeImage: true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#998;font-style:italic">#imageRepository: gcr.azk8s.cn/google_containers</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">imageRepository</span>:<span style="color:#bbb"> </span>gcr.azk8s.cn/google_containers<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">apiServer</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">extraArgs</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">storage-backend</span>:<span style="color:#bbb"> </span>etcd3<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">extraVolumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#000080">hostPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">mountPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">certSANs</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;prod-server.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;server1.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;server2.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;server3.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;server4.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;server5.k8s.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;127.0.0.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;192.168.0.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;192.168.1.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;192.168.2.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;192.168.3.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;192.168.4.1&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;kubernetes&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;kubernetes.default&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;kubernetes.default.svc&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;kubernetes.default.svc.cluster&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#d14">&#34;kubernetes.default.svc.cluster.local&#34;</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">controllerManager</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">extraArgs</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">experimental-cluster-signing-duration</span>:<span style="color:#bbb"> </span>867000h<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">extraVolumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#000080">hostPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">mountPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">scheduler</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">extraVolumes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span>- <span style="color:#000080">hostPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">mountPath</span>:<span style="color:#bbb"> </span>/etc/localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>localtime<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">networking</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># pod 网段</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">podSubnet</span>:<span style="color:#bbb"> </span><span style="color:#099">172.224.0.0</span>/12<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># SVC 网络</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">serviceSubnet</span>:<span style="color:#bbb"> </span><span style="color:#099">10.96.0.0</span>/12<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">controlPlaneEndpoint</span>:<span style="color:#bbb"> </span>server.k8s.local:8443<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">etcd</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">external</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">endpoints</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- http://server1.k8s.local:2379<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- http://server2.k8s.local:2379<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span>- http://server3.k8s.local:2379<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">apiVersion</span>:<span style="color:#bbb"> </span>kubeproxy.config.k8s.io/v1alpha1<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">kind</span>:<span style="color:#bbb"> </span>KubeProxyConfiguration<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">mode</span>:<span style="color:#bbb"> </span>ipvs<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">ipvs</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">scheduler</span>:<span style="color:#bbb"> </span>lc<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">minSyncPeriod</span>:<span style="color:#bbb"> </span>5s<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">syncPeriod</span>:<span style="color:#bbb"> </span>15s<span style="color:#bbb">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="预拉取镜像">预拉取镜像</h2>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ kubeadm config images pull --config kubeadm-config.yaml
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/kube-apiserver:v1.14.4
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/kube-controller-manager:v1.14.4
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/kube-scheduler:v1.14.4
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/kube-proxy:v1.14.4
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/pause:3.1
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">[</span>config/images<span style="color:#000;font-weight:bold">]</span> Pulled gcr.azk8s.cn/google_containers/coredns:1.2.6
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="初始化master">初始化Master</h2>
<p>预拉取镜像之后我们这步骤会十分的快很顺利。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 初始化Master</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># --experimental-upload-certs 参数的意思为将相关的证书直接上传到etcd中保存，这样省去我们手动分发证书的过程</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 注意在v1.15+版本中，已经变成正式参数，不再是实验性质 请使用 --upload-certs </span>
</span></span><span style="display:flex;"><span>➜ kubeadm init --config<span style="color:#000;font-weight:bold">=</span>kubeadm-config.yaml --experimental-upload-certs
</span></span></code></pre></td></tr></table>
</div>
</div><p>启动完成之后你可以在<code>/etc/kubernetes/pki/</code>找到kubeadm生成的证书，使用一下命令可以查看到证书的信息以及过期时间。
可以清楚的看到过期时间99年了。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  openssl x509 -in /etc/kubernetes/pki/ca.crt -noout -text
</span></span><span style="display:flex;"><span>Certificate:
</span></span><span style="display:flex;"><span>        ............
</span></span><span style="display:flex;"><span>        Validity
</span></span><span style="display:flex;"><span>            Not Before: Dec <span style="color:#099">25</span> 15:55:21 <span style="color:#099">2018</span> GMT
</span></span><span style="display:flex;"><span>            Not After : Dec  <span style="color:#099">1</span> 15:55:21 <span style="color:#099">2117</span> GMT
</span></span><span style="display:flex;"><span>        Subject: <span style="color:#008080">CN</span><span style="color:#000;font-weight:bold">=</span>kubernetes
</span></span><span style="display:flex;"><span>        Subject Public Key Info:
</span></span><span style="display:flex;"><span>         ............
</span></span><span style="display:flex;"><span> <span style="color:#0086b3">cd</span> /etc/kubernetes/pki
</span></span><span style="display:flex;"><span> openssl x509 -in ca.crt -noout -dates
</span></span><span style="display:flex;"><span> openssl x509 -in apiserver-kubelet-client.crt -noout -dates
</span></span><span style="display:flex;"><span> openssl x509 -in apiserver.crt -noout -dates
</span></span><span style="display:flex;"><span> openssl x509 -in front-proxy-ca.crt -noout -dates
</span></span><span style="display:flex;"><span> openssl x509 -in front-proxy-client.crt -noout -dates
</span></span><span style="display:flex;"><span> openssl x509 -noout -dates -in apiserver-kubelet-client.crt 
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="部署高可用master">部署高可用Master</h1>
<p>本章节的内容主要来自官方<a href="https://kubernetes.io/docs/setup/independent/high-availability/">文档</a></p>
<pre tabindex="0"><code>* 加入Master节点
在1.13中kubeadm提供了一个新的试验性标志`--experimental-control-plane`
我们只需要在`kubeadm join token --experimental-control-plane` 即可完成Master的添加。
注意：在v1.15+ 请使用 `--control-plane`
分别在Master2，3执行如下命令，成功如下正确输出
```bash
➜ kubeadm join server.k8s.local:8443 --token qiqcg7.8kg2v7txawdf6ojh --discovery-token-ca-cert-hash sha256:039b3de841b63309983911c890c967fa167c5be5a713fe0f9b6f5f4eda74b70a --experimental-control-plane
</code></pre><h1 id="kubeadm都干了什么">kubeadm都干了什么</h1>
<p>简单说下kubeadm都干了什么</p>
<ol>
<li>生成各个组件所需要的证书。存放路径在<code>/etc/kubernetes/pki</code></li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ls /etc/kubernetes/pki</span>
</span></span><span style="display:flex;"><span>apiserver.crt  apiserver-kubelet-client.crt  ca.crt  front-proxy-ca.crt  front-proxy-client.crt  sa.key
</span></span><span style="display:flex;"><span>apiserver.key  apiserver-kubelet-client.key  ca.key  front-proxy-ca.key  front-proxy-client.key  sa.pub
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="2">
<li>生成组件<code>kube-apiserver</code>，<code>kube-controller-manager</code>,<code>kube-scheduler</code> static pod yaml描述文件。</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ls /etc/kubernetes/manifests</span>
</span></span><span style="display:flex;"><span>kube-apiserver.yaml  kube-controller-manager.yaml  kube-scheduler.yaml
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="3">
<li>生成组件<code>kube-apiserver</code>，<code>kube-controller-manager</code>,<code>kube-scheduler</code>,<code>kubelet</code>,<code>kubectl</code>的配置文件。</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># ls /etc/kubernetes | grep conf</span>
</span></span><span style="display:flex;"><span>admin.conf
</span></span><span style="display:flex;"><span>bootstrap-kubelet.conf
</span></span><span style="display:flex;"><span>controller-manager.conf
</span></span><span style="display:flex;"><span>kubelet.conf
</span></span><span style="display:flex;"><span>scheduler.conf
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="4">
<li>
<p>kubelet 会自动检测（20s间隔）static pod的路径（/etc/kubernetes/manifests）是否存在yaml格式的pod描述文件，由于上面的步骤已经生成好了yaml文件，这时候kubelet会按照描述yaml启动pause容器，进而启动起来整个kubernetes的组件容器。</p>
</li>
<li>
<p>生成默认插件生成configmap配置文件。</p>
</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#查看生成的configmap</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># kubectl get configmap -nkube-system</span>
</span></span><span style="display:flex;"><span>NAME                                 DATA   AGE
</span></span><span style="display:flex;"><span>coredns                              <span style="color:#099">1</span>      3d22h
</span></span><span style="display:flex;"><span>extension-apiserver-authentication   <span style="color:#099">6</span>      3d23h
</span></span><span style="display:flex;"><span>kube-flannel-cfg                     <span style="color:#099">2</span>      3d22h
</span></span><span style="display:flex;"><span>kube-proxy                           <span style="color:#099">2</span>      3d23h
</span></span><span style="display:flex;"><span>kubeadm-config                       <span style="color:#099">2</span>      3d23h
</span></span><span style="display:flex;"><span>kubelet-config-1.14                  <span style="color:#099">1</span>      3d23h
</span></span></code></pre></td></tr></table>
</div>
</div><ol start="5">
<li>当全部容器启动成功，并通过kubeadm的检查，kubeadm将会自动的部署kube-proxy插件，coredns插件。并给出添加master和workload的cmd。</li>
</ol>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic">#查看kube-proxy的yaml描述文件</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># kubectl  get ds -nkube-system kube-proxy -oyaml </span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 查看kube-proxy插件的配置信息</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># kubectl get configmap -nkube-system -oyaml kube-proxy</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># coredns 查看和以上一直。</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="查看集群状态">查看集群状态</h2>
<ul>
<li>设置kubeconfig</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p <span style="color:#008080">$HOME</span>/.kube
</span></span><span style="display:flex;"><span>sudo cp -i /etc/kubernetes/admin.conf <span style="color:#008080">$HOME</span>/.kube/config
</span></span><span style="display:flex;"><span>sudo chown <span style="color:#000;font-weight:bold">$(</span>id -u<span style="color:#000;font-weight:bold">)</span>:<span style="color:#000;font-weight:bold">$(</span>id -g<span style="color:#000;font-weight:bold">)</span> <span style="color:#008080">$HOME</span>/.kube/config
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查看node，你可以发现我们的master节点已经启动好了3台了，status是NotReady，这不用管，这是因为我们还没安装网络插件导致的。我们在下一章专门讲解。</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜ kubectl get node
</span></span><span style="display:flex;"><span>NAME                STATUS     ROLES    AGE     VERSION
</span></span><span style="display:flex;"><span>server1.k8s.local   NotReady   master   17m     v1.14.2
</span></span><span style="display:flex;"><span>server2.k8s.local   NotReady   master   3m10s   v1.14.2
</span></span><span style="display:flex;"><span>server3.k8s.local   NotReady   master   2m56s   v1.14.2
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>查看static Pods coredns 状态是<code>ContainerCreating</code>，原因依然是网络插件的问题。我们在下一章专门讲解。</li>
</ul>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>➜  kubectl get pods -nkube-system
</span></span><span style="display:flex;"><span>NAME                                        READY   STATUS              RESTARTS   AGE
</span></span><span style="display:flex;"><span>coredns-89cc84847-2s5xq                     0/1     ContainerCreating   <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>coredns-89cc84847-4cbqf                     0/1     ContainerCreating   <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>kube-apiserver-server1.k8s.local            1/1     Running             <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>kube-apiserver-server2.k8s.local            1/1     Running             <span style="color:#099">0</span>          2m29s
</span></span><span style="display:flex;"><span>kube-apiserver-server3.k8s.local            1/1     Running             <span style="color:#099">0</span>          2m14s
</span></span><span style="display:flex;"><span>kube-controller-manager-server1.k8s.local   1/1     Running             <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>kube-controller-manager-server2.k8s.local   1/1     Running             <span style="color:#099">0</span>          2m29s
</span></span><span style="display:flex;"><span>kube-controller-manager-server3.k8s.local   1/1     Running             <span style="color:#099">0</span>          2m14s
</span></span><span style="display:flex;"><span>kube-proxy-5mgrq                            1/1     Running             <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>kube-proxy-b6wpc                            1/1     Running             <span style="color:#099">0</span>          2m29s
</span></span><span style="display:flex;"><span>kube-proxy-j7gnq                            1/1     Running             <span style="color:#099">0</span>          2m15s
</span></span><span style="display:flex;"><span>kube-scheduler-server1.k8s.local            1/1     Running             <span style="color:#099">0</span>          16m
</span></span><span style="display:flex;"><span>kube-scheduler-server2.k8s.local            1/1     Running             <span style="color:#099">0</span>          2m29s
</span></span><span style="display:flex;"><span>kube-scheduler-server3.k8s.local            1/1     Running             <span style="color:#099">0</span>          2m14s
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="清理">清理</h1>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>rm -rf <span style="color:#008080">$HOME</span>/.kube
</span></span><span style="display:flex;"><span>kubeadm reset <span style="color:#000;font-weight:bold">&amp;&amp;</span> rm -rf ~/.kube <span style="color:#000;font-weight:bold">&amp;&amp;</span> ipvsadm --clear
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>kubectl drain &lt;node name&gt; --delete-local-data --force --ignore-daemonsets
</span></span><span style="display:flex;"><span>kubectl delete node &lt;node name&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="添加新的节点集群中">添加新的节点集群中</h1>
<p>默认生成的token有效期只有24小时，当超过24小时之后tokne会失效，我们可以使用一下方式来添加新的node节点。</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 创建一个新的token</span>
</span></span><span style="display:flex;"><span>kubeadm token create
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 查看token列表</span>
</span></span><span style="display:flex;"><span>kubeadm token list
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 获取ca证书sha256编码hash值</span>
</span></span><span style="display:flex;"><span>openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed <span style="color:#d14">&#39;s/^.* //&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"># 最终生成的cmd</span>
</span></span><span style="display:flex;"><span>kubeadm join server.k8s.local:8443 --token <span style="color:#d14">${</span><span style="color:#008080">TOKEN</span><span style="color:#d14">}</span> --discovery-token-ca-cert-hash sha256:<span style="color:#d14">${</span><span style="color:#008080">CaSHA256</span><span style="color:#d14">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="缩短pod重启">缩短pod重启</h1>
<p>在应用中，想要缩短pod的重启时间，可以修改一下几个参数
kube-controller-manager配置：</p>
<div class="highlight"><div style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>--node-monitor-grace-period<span style="color:#000;font-weight:bold">=</span>10s <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--node-monitor-period<span style="color:#000;font-weight:bold">=</span>3s <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--node-startup-grace-period<span style="color:#000;font-weight:bold">=</span>20s <span style="color:#d14">\
</span></span></span><span style="display:flex;"><span><span style="color:#d14"></span>--pod-eviction-timeout<span style="color:#000;font-weight:bold">=</span>10s <span style="color:#d14">\
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>kubernetes节点失效后pod的调度过程：</p>
<p>0、Master每隔一段时间和node联系一次，判定node是否失联，这个时间周期配置项为 node-monitor-period ，默认5s</p>
<p>1、当node失联后一段时间后，kubernetes判定node为notready状态，这段时长的配置项为 node-monitor-grace-period ，默认40s</p>
<p>2、当node失联后一段时间后，kubernetes判定node为unhealthy，这段时长的配置项为 node-startup-grace-period ，默认1m0s</p>
<p>3、当node失联后一段时间后，kubernetes开始删除原node上的pod，这段时长配置项为 pod-eviction-timeout ，默认5m0s</p>
<h1 id="参考资料">参考资料</h1>
<ul>
<li><a href="https://kubernetes.io/docs/setup/independent/high-availability/">Creating Highly Available Clusters with kubeadm</a></li>
<li><a href="https://kubernetes.io/docs/setup/independent/setup-ha-etcd-with-kubeadm/">Set up a High Availability etcd cluster with kubeadm</a></li>
<li><a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/clustering.md">如何构建一个etcd集群</a></li>
<li><a href="https://github.com/etcd-io/etcd/blob/master/Documentation/op-guide/security.md">如何构建一个etcd-tls集群</a></li>
</ul>
<p>docker run &ndash;rm -it <br>
&ndash;net host <br>
-v /etc/kubernetes:/etc/kubernetes quay.azk8s.cn/coreos/etcd:v3.4.3 etcdctl <br>
&ndash;cert-file /etc/kubernetes/pki/etcd/peer.crt <br>
&ndash;key-file /etc/kubernetes/pki/etcd/peer.key <br>
&ndash;ca-file /etc/kubernetes/pki/etcd/ca.crt <br>
&ndash;endpoints https://127.0.0.1:2379 cluster-health</p>
        </div>

        
<div class="post-archive">
    <ul class="post-copyright">
        <li><strong>原文作者：</strong><a rel="author" href="https://www.flysnow.org">青木</a></li>
        <li style="word-break:break-all"><strong>原文链接：</strong><a href="https://www.flysnow.org/posts/Deploy-a-highly-available-cluster-with-kubeadm/">https://www.flysnow.org/posts/Deploy-a-highly-available-cluster-with-kubeadm/</a></li>
        <li><strong>版权声明：</strong>本作品采用<a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">知识共享署名-非商业性使用-禁止演绎 4.0 国际许可协议</a>进行许可，非商业转载请注明出处（作者，原文链接），商业转载请联系作者获得授权。</li>
    </ul>
</div>
<br/>



        

<div class="post-archive">
    <h2>See Also</h2>
    <ul class="listing">
        
        <li><a href="/posts/HAProxy-Spring-Gateway-Connection-reset-by-peer/">Spring Gateway syscall:read(..) Connection reset by peer</a></li>
        
        <li><a href="/posts/How-to-securely-limit-JVM-resources-in-a-container/">容器中的JVM资源该如何被安全的限制？</a></li>
        
        <li><a href="/about/">关于我</a></li>
        
        <li><a href="/posts/Zuul-processing-flow-and-business-extension-point-2/">Zuul源码分析(2)Filter分析</a></li>
        
        <li><a href="/posts/Zuul-processing-flow-and-business-extension-point/">Zuul源码分析(1)生命周期</a></li>
        
    </ul>
</div>


        <div class="post-meta meta-tags">
            
            <ul class="clearfix">
                
                <li><a href='/tags/Kubernetes'>Kubernetes</a></li>
                
            </ul>
            
        </div>
    </article>
    
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "yourdiscussshortname" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    
    
    <div class="post bg-white">
      <script src="https://utteranc.es/client.js"
            repo= "your github repo"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
      </script>
    </div>
    
    
    

</div>

                    <footer id="footer">
    <div>
        &copy; 2022 <a href="https://www.flysnow.org">青木的博客 By 青木</a>
        
    </div>
    <br />
    <div>
        <div class="github-badge">
            <a href="https://gohugo.io/" target="_black" rel="nofollow"><span class="badge-subject">Powered by</span><span class="badge-value bg-blue">Hugo</span></a>
        </div>
        <div class="github-badge">
            <a href="https://www.flysnow.org/" target="_black"><span class="badge-subject">Design by</span><span class="badge-value bg-brightgreen">青木</span></a>
        </div>
        <div class="github-badge">
            <a href="https://github.com/flysnow-org/maupassant-hugo" target="_black"><span class="badge-subject">Theme</span><span class="badge-value bg-yellowgreen">Maupassant</span></a>
        </div>
    </div>
</footer>


    
    
    <script type="text/javascript">
        window.MathJax = {
            tex2jax: {
                inlineMath: [['$', '$']],
                processEscapes: true
                }
            };
    </script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>

<a id="rocket" href="#top"></a>
<script type="text/javascript" src='/js/totop.js?v=0.0.0' async=""></script>
    <script type="text/javascript" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>




    <script src='/js/douban.js'></script>

                </div>

                <div id="secondary">
    <section class="widget">
        <form id="search" action='https://www.flysnow.org/search' method="get" accept-charset="utf-8" target="_blank" _lpchecked="1">
      
      <input type="text" name="q" maxlength="20" placeholder="Search">
      <input type="hidden" name="sitesearch" value="https://www.flysnow.org">
      <button type="submit" class="submit icon-search"></button>
</form>
    </section>
    
    <section class="widget">
        <h3 class="widget-title">最近文章</h3>
<ul class="widget-list">
    
    <li>
        <a href="https://www.flysnow.org/posts/Spring-Boot-Operator-User-Guide/" title="使用Spring Boot Operator部署SpringBoot到K8S">使用Spring Boot Operator部署SpringBoot到K8S</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Monitor-ETCD/" title="Prometheus Operator监控ETCD">Prometheus Operator监控ETCD</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Monitor-springboot-microservices/" title="Prometheus Operator监控SpringCloud">Prometheus Operator监控SpringCloud</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Customize-your-kube-prometheus/" title="优雅的使用Prometheus Operator">优雅的使用Prometheus Operator</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-the-business-service-to-complete-the-service-call-using-Feign/" title="部署业务并使用Feign进行服务间调用（附带一部分源码分析）">部署业务并使用Feign进行服务间调用（附带一部分源码分析）</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-mysql-on-kubernetes/" title="从部署mysql聊一聊有状态服务和PV及PVC">从部署mysql聊一聊有状态服务和PV及PVC</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-distributed-trace-zipkin-in-kubernetes/" title="在kubernetes运行分布式追踪zipkin">在kubernetes运行分布式追踪zipkin</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-the-configuration-hub-cluster-on-kubernetes/" title="在kubernetes上运行SpringCloud配置中心">在kubernetes上运行SpringCloud配置中心</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-eureka-cluster-on-kubernetes/" title="在kubernetes上运行eureka集群">在kubernetes上运行eureka集群</a>
    </li>
    
    <li>
        <a href="https://www.flysnow.org/posts/Run-Spring-Cloud-Gateway-on-kubernetes-2/" title="在kubernetes上运行Spring Cloud Gateway（二）">在kubernetes上运行Spring Cloud Gateway（二）</a>
    </li>
    
</ul>
    </section>

    

    <section class="widget">
        <h3 class="widget-title"><a href='/categories/'>分类</a></h3>
<ul class="widget-list">
    
    <li><a href="https://www.flysnow.org/categories/%E5%90%8E%E7%AB%AF/">后端 (1)</a></li>
    
</ul>
    </section>

    <section class="widget">
        <h3 class="widget-title"><a href='/tags/'>标签</a></h3>
<div class="tagcloud">
    
    <a href="https://www.flysnow.org/tags/EFK/">EFK</a>
    
    <a href="https://www.flysnow.org/tags/Java/">Java</a>
    
    <a href="https://www.flysnow.org/tags/kubernetes/">kubernetes</a>
    
    <a href="https://www.flysnow.org/tags/Mysql/">Mysql</a>
    
    <a href="https://www.flysnow.org/tags/Prometheus/">Prometheus</a>
    
    <a href="https://www.flysnow.org/tags/SpringBoot/">SpringBoot</a>
    
    <a href="https://www.flysnow.org/tags/SpringCloud/">SpringCloud</a>
    
    <a href="https://www.flysnow.org/tags/SpringGateway/">SpringGateway</a>
    
    <a href="https://www.flysnow.org/tags/docker/">docker</a>
    
    <a href="https://www.flysnow.org/tags/elasticsearch/">elasticsearch</a>
    
    <a href="https://www.flysnow.org/tags/gitlab/">gitlab</a>
    
    <a href="https://www.flysnow.org/tags/hpa/">hpa</a>
    
    <a href="https://www.flysnow.org/tags/jvm/">jvm</a>
    
    <a href="https://www.flysnow.org/tags/kafka/">kafka</a>
    
    <a href="https://www.flysnow.org/tags/kubernetes/">kubernetes</a>
    
    <a href="https://www.flysnow.org/tags/metrics-server/">metrics-server</a>
    
    <a href="https://www.flysnow.org/tags/springclod/">springclod</a>
    
    <a href="https://www.flysnow.org/tags/zuul/">zuul</a>
    
    <a href="https://www.flysnow.org/tags/%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86/">异常处理</a>
    
    <a href="https://www.flysnow.org/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/">微服务</a>
    
    <a href="https://www.flysnow.org/tags/%E6%BA%90%E7%A0%81/">源码</a>
    
    <a href="https://www.flysnow.org/tags/%E7%9B%91%E6%8E%A7/">监控</a>
    
</div>
    </section>

    
<section class="widget">
    <h3 class="widget-title">友情链接</h3>
    <ul class="widget-list">
        
        <li>
            <a target="_blank" href="https://www.flysnow.org/" title="青木的博客">青木的博客</a>
        </li>
        
    </ul>
</section>


    <section class="widget">
        <h3 class="widget-title">其它</h3>
        <ul class="widget-list">
            <li><a href="https://www.flysnow.org/index.xml">文章 RSS</a></li>
        </ul>
    </section>
</div>
            </div>
        </div>
    </div>
</body>

</html>